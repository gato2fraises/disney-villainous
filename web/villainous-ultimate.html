<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Disney Villainous‚Ñ¢ - Official Digital Edition | Professional Game</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-gold: #D4AF37;
            --primary-purple: #4A148C;
            --primary-dark: #1A0E33;
            --secondary-blue: #1565C0;
            --accent-red: #B71C1C;
            --text-light: #F5F5F5;
            --text-dark: #212121;
            --surface-dark: #2E1065;
            --surface-light: rgba(255, 255, 255, 0.1);
            --shadow-main: 0 8px 32px rgba(0, 0, 0, 0.3);
            --gradient-main: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-purple) 50%, var(--secondary-blue) 100%);
            --gradient-gold: linear-gradient(135deg, #FFD700 0%, #FFA000 50%, #FF8F00 100%);
            --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--gradient-main);
            background-attachment: fixed;
            color: var(--text-light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Loading Screen Professionnel */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-main);
            z-index: 3000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .studio-logo {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            color: var(--text-light);
            margin-bottom: 2rem;
            opacity: 0;
            animation: fadeInOut 3s ease-in-out;
        }

        .game-logo-loading {
            font-family: 'Cinzel', serif;
            font-size: 4rem;
            font-weight: 700;
            background: var(--gradient-gold);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
            margin-bottom: 1rem;
            opacity: 0;
            animation: fadeInOut 3s ease-in-out 2s;
        }

        .loading-subtitle {
            font-size: 1.2rem;
            color: var(--text-light);
            margin-bottom: 3rem;
            opacity: 0;
            animation: fadeInOut 3s ease-in-out 2s;
        }

        .loading-bar-container {
            width: 400px;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 1rem;
            opacity: 0;
            animation: fadeInOut 3s ease-in-out 3s;
        }

        .loading-bar {
            height: 100%;
            background: var(--gradient-gold);
            width: 0%;
            animation: loadProgress 3s ease-out 3s forwards;
        }

        .loading-percentage {
            color: var(--text-light);
            font-size: 1rem;
            font-weight: 600;
            opacity: 0;
            animation: fadeInOut 3s ease-in-out 3s;
        }

        @keyframes fadeInOut {
            0% { opacity: 0; }
            50% { opacity: 1; }
            100% { opacity: 1; }
        }

        @keyframes loadProgress {
            to { width: 100%; }
        }

        /* Header de jeu professionnel */
        .game-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(26, 14, 51, 0.95);
            backdrop-filter: blur(15px);
            border-bottom: 2px solid var(--primary-gold);
            padding: 0.8rem 2rem;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1600px;
            margin: 0 auto;
        }

        .game-info {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .logo-header {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--gradient-gold);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .game-status {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .status-value {
            color: var(--primary-gold);
            font-weight: 600;
        }

        .header-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .control-btn {
            background: var(--surface-dark);
            border: 1px solid var(--primary-gold);
            color: var(--text-light);
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .control-btn:hover {
            background: var(--primary-gold);
            color: var(--primary-dark);
        }

        .control-btn.primary {
            background: var(--gradient-gold);
            color: var(--primary-dark);
            border: none;
        }

        /* Interface de jeu principale */
        .game-interface {
            margin-top: 70px;
            padding: 1rem;
            max-width: 1600px;
            margin-left: auto;
            margin-right: auto;
            display: none;
        }

        .game-interface.active {
            display: block;
        }

        .game-layout {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            grid-template-rows: auto 1fr auto;
            gap: 1rem;
            height: calc(100vh - 90px);
        }

        /* Panneau gauche - Joueur actuel */
        .player-panel {
            background: var(--surface-dark);
            border-radius: 15px;
            padding: 1.5rem;
            border: 2px solid var(--primary-gold);
            box-shadow: var(--shadow-main);
        }

        .player-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--gradient-gold);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            margin: 0 auto 1rem;
            border: 3px solid var(--primary-gold);
        }

        .player-name {
            text-align: center;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-light);
        }

        .villain-name {
            text-align: center;
            font-family: 'Cinzel', serif;
            color: var(--primary-gold);
            margin-bottom: 1.5rem;
        }

        .player-stats {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        .stat-label {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .stat-value {
            color: var(--primary-gold);
            font-weight: 600;
            font-size: 1.1rem;
        }

        /* ===== STRUCTURE OFFICIELLE DISNEY VILLAINOUS ===== */
        
        /* Zone de jeu centrale */
        .game-board {
            background: var(--surface-dark);
            border-radius: 20px;
            padding: 2rem;
            border: 3px solid var(--primary-gold);
            box-shadow: var(--shadow-main);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .board-title {
            font-family: 'Cinzel', serif;
            font-size: 1.8rem;
            text-align: center;
            margin-bottom: 1rem;
            color: var(--primary-gold);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        /* Zones de cartes s√©par√©es comme dans le vrai jeu */
        .fate-cards-zone,
        .villain-cards-zone {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 1rem;
            border: 2px dashed rgba(255, 255, 255, 0.2);
            min-height: 80px;
        }

        .fate-cards-zone {
            border-color: rgba(220, 20, 60, 0.4);
            background: rgba(220, 20, 60, 0.1);
        }

        .villain-cards-zone {
            border-color: rgba(218, 165, 32, 0.4);
            background: rgba(218, 165, 32, 0.1);
        }

        .zone-title {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 0.5rem;
            text-align: center;
        }

        .fate-cards-container,
        .villain-cards-container {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .empty-zone {
            text-align: center;
            color: rgba(255, 255, 255, 0.4);
            font-style: italic;
            padding: 1.5rem;
            font-size: 0.9rem;
        }

        /* Zone des 4 lieux - layout horizontal */
        .locations-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin: 1rem 0;
        }

        .location-card {
            background: linear-gradient(135deg, var(--primary-dark), var(--surface-dark));
            border: 2px solid transparent;
            border-radius: 15px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            min-height: 140px;
            display: flex;
            flex-direction: column;
        }

        .location-card:hover {
            border-color: var(--primary-gold);
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(212, 175, 55, 0.3);
        }

        .location-card.active {
            border-color: var(--primary-gold);
            background: linear-gradient(135deg, var(--primary-gold), #FFA000);
            color: var(--primary-dark);
            box-shadow: 0 0 20px rgba(218, 165, 32, 0.5);
        }

        .location-name {
            font-family: 'Cinzel', serif;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            text-align: center;
            min-height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Actions en grille 2x2 comme dans le vrai jeu */
        .location-actions {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
            flex-grow: 1;
        }

        .action-row {
            display: flex;
            gap: 0.3rem;
            justify-content: center;
        }

        .action-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: var(--primary-gold);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            color: var(--primary-dark);
            transition: all 0.2s ease;
            cursor: pointer;
            position: relative;
        }

        .action-icon:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(218, 165, 32, 0.4);
        }

        .action-icon.empty {
            background: transparent;
            border: 2px dashed rgba(255, 255, 255, 0.2);
            cursor: default;
        }

        /* Actions bloqu√©es par les H√©ros */
        .action-icon[data-blocked-by-heroes="true"]:after {
            content: 'üõ°Ô∏è';
            position: absolute;
            top: -5px;
            right: -5px;
            font-size: 0.6rem;
            background: rgba(220, 20, 60, 0.9);
            border-radius: 50%;
            width: 14px;
            height: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Figurine du joueur */
        .player-figure {
            position: absolute;
            bottom: 5px;
            right: 5px;
            font-size: 1.2rem;
            z-index: 10;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-8px); }
            60% { transform: translateY(-4px); }
        }

        /* Zone des pioches */
        .decks-zone {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
        }

        .deck-pile {
            background: var(--surface-medium);
            border: 2px solid var(--primary-gold);
            border-radius: 10px;
            padding: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            min-width: 80px;
        }

        .deck-pile:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(218, 165, 32, 0.3);
        }

        .deck-icon {
            font-size: 1.5rem;
            margin-bottom: 0.3rem;
        }

        .deck-title {
            font-size: 0.7rem;
            font-weight: 600;
            margin-bottom: 0.2rem;
        }

        .deck-count {
            font-size: 1rem;
            font-weight: 700;
            color: var(--primary-gold);
        }

        .villain-deck {
            border-color: var(--primary-gold);
        }

        .fate-deck {
            border-color: #DC143C;
        }

        .fate-deck .deck-icon {
            color: #DC143C;
        }

        .discard-pile {
            border-color: #666;
            opacity: 0.7;
        }

        /* ===== RESPONSIVE POUR MOBILES ===== */
        
        /* S√©lecteur de m√©chant */
        .villain-selector {
            max-width: 800px;
            margin: 0 auto;
        }

        .villain-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            max-height: 60vh;
            overflow-y: auto;
        }

        .villain-option {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border: 2px solid #DAA520;
            border-radius: 15px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .villain-option:hover {
            border-color: #FFA000;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(218, 165, 32, 0.3);
        }

        .villain-icon {
            font-size: 4rem;
            text-align: center;
            min-width: 80px;
        }

        .villain-info h3 {
            color: #DAA520;
            font-family: 'Cinzel', serif;
            font-size: 1.4rem;
            margin: 0 0 0.5rem 0;
        }

        .villain-desc {
            color: rgba(245, 245, 245, 0.8);
            font-size: 0.9rem;
            margin: 0 0 0.5rem 0;
            line-height: 1.4;
        }

        .victory-condition {
            color: #FFA000;
            font-weight: 600;
            font-size: 0.9rem;
            margin: 0 0 0.5rem 0;
        }

        .villain-stats {
            color: rgba(245, 245, 245, 0.6);
            font-size: 0.8rem;
            margin: 0;
        }

        /* Marqueurs sp√©ciaux sur le plateau */
        .victory-marker {
            position: absolute;
            top: -8px;
            left: -8px;
            font-size: 1.2rem;
            z-index: 10;
            animation: trophy-glow 2s infinite alternate;
        }

        .curse-marker {
            position: absolute;
            top: -10px;
            right: -10px;
            font-size: 1.5rem;
            z-index: 10;
            animation: curse-glow 2s infinite alternate;
        }

        @keyframes trophy-glow {
            0% { 
                transform: scale(1);
                filter: brightness(1);
            }
            100% { 
                transform: scale(1.1);
                filter: brightness(1.3) drop-shadow(0 0 10px #FFD700);
            }
        }

        @keyframes curse-glow {
            0% { 
                transform: scale(1);
                filter: brightness(1) hue-rotate(0deg);
            }
            100% { 
                transform: scale(1.1);
                filter: brightness(1.3) hue-rotate(15deg) drop-shadow(0 0 10px #8B008B);
            }
        }

        /* Bonus temporaires */
        .boarding-bonus {
            border: 2px solid #32CD32 !important;
            box-shadow: 0 0 15px rgba(50, 205, 50, 0.5) !important;
            animation: power-boost 1s ease;
        }

        .moved-item {
            border: 2px solid #1E90FF !important;
            box-shadow: 0 0 15px rgba(30, 144, 255, 0.5) !important;
        }

        @keyframes power-boost {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Cartes Fatalit√© sp√©ciales */
        .fate-card.hero {
            border-color: #DC143C;
            background: linear-gradient(135deg, #8B0000, #DC143C);
        }

        .fate-card.item {
            border-color: #FF6347;
            background: linear-gradient(135deg, #CD5C5C, #FF6347);
        }

        .fate-card.effect {
            border-color: #FF1493;
            background: linear-gradient(135deg, #C71585, #FF1493);
        }

        /* Responsive pour mobiles */
        @media (max-width: 768px) {
            .villain-option {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }

            .villain-icon {
                min-width: auto;
            }

            .villain-options {
                grid-template-columns: 1fr;
            }

            .locations-container {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.5rem;
            }

            .location-card {
                min-height: 120px;
                padding: 0.8rem;
            }

            .location-name {
                font-size: 0.8rem;
                min-height: 2rem;
            }

            .action-icon {
                width: 28px;
                height: 28px;
                font-size: 0.8rem;
            }
        }

        .action-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--primary-gold);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: var(--primary-dark);
            margin: 0 auto;
        }

        /* Panneau droit - Actions et cartes */
        .actions-panel {
            background: var(--surface-dark);
            border-radius: 15px;
            padding: 1.5rem;
            border: 2px solid var(--primary-gold);
            box-shadow: var(--shadow-main);
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .panel-title {
            font-family: 'Cinzel', serif;
            font-size: 1.3rem;
            color: var(--primary-gold);
            text-align: center;
            margin-bottom: 1rem;
        }

        .objective-box {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 1rem;
            border-left: 4px solid var(--primary-gold);
        }

        .objective-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-light);
        }

        .objective-text {
            font-size: 0.9rem;
            color: rgba(245, 245, 245, 0.8);
            line-height: 1.4;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 1rem;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-gold);
            transition: width 0.5s ease;
        }

        /* Main du joueur */
        .player-hand {
            grid-column: 1 / -1;
            background: var(--surface-dark);
            border-radius: 15px;
            padding: 1.5rem;
            border: 2px solid var(--primary-gold);
            box-shadow: var(--shadow-main);
        }

        .hand-title {
            font-family: 'Cinzel', serif;
            font-size: 1.2rem;
            color: var(--primary-gold);
            margin-bottom: 1rem;
            text-align: center;
        }

        .cards-container {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding: 1rem 0;
        }

        .game-card {
            min-width: 200px;
            height: 280px;
            background: linear-gradient(135deg, var(--primary-dark), var(--surface-dark));
            border: 2px solid var(--primary-gold);
            border-radius: 15px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
        }

        .game-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 20px 50px rgba(212, 175, 55, 0.4);
            z-index: 10;
        }

        .game-card.selected {
            border: 3px solid #FFD700;
            transform: scale(1.02);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }

        .card-cost {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--primary-gold);
            color: var(--primary-dark);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .card-image {
            width: 100%;
            height: 120px;
            background: var(--gradient-gold);
            border-radius: 10px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: var(--primary-dark);
        }

        .card-name {
            font-family: 'Cinzel', serif;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-light);
        }

        .card-description {
            font-size: 0.8rem;
            color: rgba(245, 245, 245, 0.8);
            line-height: 1.3;
        }

        /* Menu contextuel */
        .context-menu {
            position: fixed;
            background: var(--surface-dark);
            border: 2px solid var(--primary-gold);
            border-radius: 10px;
            padding: 1rem;
            z-index: 2000;
            display: none;
            box-shadow: var(--shadow-main);
        }

        .menu-item {
            padding: 0.5rem 1rem;
            cursor: pointer;
            border-radius: 5px;
            transition: background 0.2s ease;
            color: var(--text-light);
        }

        .menu-item:hover {
            background: var(--primary-gold);
            color: var(--primary-dark);
        }

        /* Animations */
        .fade-in {
            animation: fadeInUp 0.8s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .game-layout {
                grid-template-columns: 250px 1fr;
                grid-template-rows: auto 1fr auto auto;
            }
            
            .actions-panel {
                grid-column: 1 / -1;
            }
        }

        @media (max-width: 768px) {
            .game-layout {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto 1fr auto;
            }
            
            .locations-container {
                grid-template-columns: repeat(2, 1fr);
                height: auto;
            }
            
            .cards-container {
                justify-content: center;
            }
            
            .game-card {
                min-width: 150px;
                height: 220px;
            }
        }

        /* Menu principal */
        .main-menu {
            padding: 2rem;
            text-align: center;
        }

        .menu-title {
            font-family: 'Cinzel', serif;
            font-size: 3rem;
            margin-bottom: 1rem;
            background: var(--gradient-gold);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .menu-subtitle {
            font-size: 1.2rem;
            margin-bottom: 3rem;
            color: rgba(245, 245, 245, 0.9);
        }

        .menu-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            max-width: 400px;
            margin: 0 auto;
        }

        .menu-btn {
            background: var(--surface-dark);
            border: 2px solid var(--primary-gold);
            color: var(--text-light);
            padding: 1rem 2rem;
            border-radius: 10px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .menu-btn:hover {
            background: var(--primary-gold);
            color: var(--primary-dark);
            transform: translateY(-2px);
        }

        .menu-btn.primary {
            background: var(--gradient-gold);
            color: var(--primary-dark);
            border: none;
        }

        /* ===== PLATEAUX TH√âMATIQUES DISNEY VILLAINOUS ===== */
        
        /* Couleurs th√©matiques par m√©chant */
        .villain-board.captain-hook {
            --theme-primary: #2C5F41;
            --theme-secondary: #8B4513;
            --theme-accent: #DAA520;
            --theme-bg: linear-gradient(135deg, #1e3a5f 0%, #2c5f41 100%);
        }

        .villain-board.maleficent {
            --theme-primary: #4A0E4E;
            --theme-secondary: #2F1B69;
            --theme-accent: #9400D3;
            --theme-bg: linear-gradient(135deg, #1a0033 0%, #4a0e4e 100%);
        }

        .villain-board.jafar {
            --theme-primary: #8B4513;
            --theme-secondary: #CD853F;
            --theme-accent: #FFD700;
            --theme-bg: linear-gradient(135deg, #8b4513 0%, #daa520 100%);
        }

        .villain-board.queen-hearts {
            --theme-primary: #DC143C;
            --theme-secondary: #B22222;
            --theme-accent: #FFD700;
            --theme-bg: linear-gradient(135deg, #8b0000 0%, #dc143c 100%);
        }

        .villain-board.prince-john {
            --theme-primary: #4B0082;
            --theme-secondary: #6A5ACD;
            --theme-accent: #FFD700;
            --theme-bg: linear-gradient(135deg, #2e2e5c 0%, #4b0082 100%);
        }

        /* Plateau de base avec th√®me */
        .villain-board {
            background: var(--theme-bg, var(--gradient-main));
            border: 2px solid var(--theme-accent, var(--primary-gold));
            position: relative;
            overflow: hidden;
        }

        .villain-board::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, 
                transparent 30%, 
                rgba(255, 255, 255, 0.1) 50%, 
                transparent 70%);
            transform: rotate(45deg);
            animation: boardShine 8s infinite;
            pointer-events: none;
        }

        @keyframes boardShine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        /* Lieux avec th√®mes */
        .villain-board .location-card {
            background: var(--theme-primary, var(--surface-dark));
            border-color: var(--theme-accent, var(--primary-gold));
        }

        .villain-board .location-card:hover {
            box-shadow: 0 0 20px var(--theme-accent, var(--primary-gold));
        }

        .villain-board .location-card.active {
            background: var(--theme-accent, var(--primary-gold));
            color: var(--primary-dark);
            animation: crownFloat 2s ease-in-out infinite;
        }

        .villain-board .location-card.active::after {
            content: 'üëë';
            position: absolute;
            top: -10px;
            right: -10px;
            font-size: 20px;
            animation: crownFloat 2s ease-in-out infinite;
        }

        @keyframes crownFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-5px) rotate(5deg); }
        }

        /* Effets magiques par lieu */
        .location-card.magical-effect {
            animation: magicalPulse 3s ease-in-out infinite;
        }

        @keyframes magicalPulse {
            0%, 100% { box-shadow: 0 0 20px rgba(148, 0, 211, 0.4); }
            50% { box-shadow: 0 0 40px rgba(148, 0, 211, 0.8); }
        }

        .location-card.treasure-effect {
            animation: treasureGlow 2s ease-in-out infinite;
        }

        @keyframes treasureGlow {
            0%, 100% { box-shadow: 0 0 15px rgba(255, 215, 0, 0.4); }
            50% { box-shadow: 0 0 30px rgba(255, 215, 0, 0.8); }
        }

        /* Transitions de plateau */
        .board-transition-enter {
            animation: boardSlideIn 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .board-transition-exit {
            animation: boardSlideOut 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes boardSlideIn {
            from { opacity: 0; transform: translateY(50px) scale(0.9); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        @keyframes boardSlideOut {
            from { opacity: 1; transform: translateY(0) scale(1); }
            to { opacity: 0; transform: translateY(-50px) scale(0.9); }
        }

        /* Actions th√©matiques */
        .action-icon.blocked::after {
            content: 'üö´';
            position: absolute;
            right: -5px;
            top: -5px;
            font-size: 12px;
        }

        /* Particules et effets */
        .location-ripple {
            position: absolute;
            top: 50%;
            left: 50%;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: 1000;
        }

        /* ===== S√âLECTION DES M√âCHANTS ===== */
        .villain-selection {
            margin: 2rem 0;
        }

        .villain-card {
            background: var(--surface-dark);
            border: 2px solid var(--primary-gold);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .villain-card:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 20px 40px rgba(212, 175, 55, 0.4);
            border-color: #FFD700;
        }

        .villain-card.selected {
            border-color: #FFD700;
            background: linear-gradient(135deg, var(--primary-gold), #FFA000);
            color: var(--primary-dark);
            transform: scale(1.02);
        }

        .villain-card.coming-soon {
            opacity: 0.6;
            cursor: not-allowed;
            border-style: dashed;
        }

        .villain-card.coming-soon:hover {
            transform: none;
            box-shadow: none;
        }

        .villain-icon {
            font-size: 3rem;
            margin-bottom: 0.5rem;
            filter: drop-shadow(0 0 10px rgba(212, 175, 55, 0.5));
        }

        .villain-name {
            font-family: 'Cinzel', serif;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-light);
        }

        .villain-card.selected .villain-name {
            color: var(--primary-dark);
        }

        .villain-difficulty {
            font-size: 0.9rem;
            color: var(--primary-gold);
            filter: drop-shadow(0 0 5px rgba(212, 175, 55, 0.8));
        }
        
    </style>
</head>

<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="studio-logo">VILLAIN STUDIOS</div>
        <div class="game-logo-loading">Disney Villainous‚Ñ¢</div>
        <div class="loading-subtitle">Official Digital Edition</div>
        <div class="loading-bar-container">
            <div class="loading-bar"></div>
        </div>
        <div class="loading-percentage" id="loadingPercentage">0%</div>
    </div>

    <!-- Header de jeu -->
    <header class="game-header">
        <div class="header-content">
            <div class="game-info">
                <div class="logo-header">Disney Villainous‚Ñ¢</div>
                <div class="game-status">
                    <div class="status-item">
                        <span>Tour:</span>
                        <span class="status-value" id="turnNumber">1</span>
                    </div>
                    <div class="status-item">
                        <span>Joueur:</span>
                        <span class="status-value" id="currentPlayer">Jafar</span>
                    </div>
                    <div class="status-item">
                        <span>Temps:</span>
                        <span class="status-value" id="gameTimer">00:00</span>
                    </div>
                </div>
            </div>
            
            <div class="header-controls">
                <button class="control-btn" onclick="showHelp()">‚ùì Aide</button>
                <button class="control-btn" onclick="showSettings()">‚öôÔ∏è Options</button>
                <button class="control-btn" onclick="saveGame()">üíæ Sauvegarder</button>
                <button class="control-btn primary" onclick="endTurn()">‚è≠Ô∏è Fin du Tour</button>
            </div>
        </div>
    </header>

    <!-- Menu Principal -->
    <div class="main-menu" id="mainMenu">
        <h1 class="menu-title">Disney Villainous‚Ñ¢</h1>
        <p class="menu-subtitle">Professional Digital Edition</p>
        
        <!-- S√©lection des M√©chants -->
        <div class="villain-selection">
            <h3 style="color: var(--primary-gold); margin-bottom: 1rem; text-align: center;">Choisissez Votre M√©chant</h3>
            <div class="villain-grid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-bottom: 2rem;">
                <div class="villain-card" onclick="selectVillainForGame('jafar')" data-villain="jafar">
                    <div class="villain-icon">üßû‚Äç‚ôÇÔ∏è</div>
                    <div class="villain-name">Jafar</div>
                    <div class="villain-difficulty">‚≠ê‚≠ê‚≠ê‚≠ê</div>
                </div>
                <div class="villain-card" onclick="selectVillainForGame('maleficent')" data-villain="maleficent">
                    <div class="villain-icon">üßô‚Äç‚ôÄÔ∏è</div>
                    <div class="villain-name">Maleficent</div>
                    <div class="villain-difficulty">‚≠ê‚≠ê‚≠ê</div>
                </div>
                <div class="villain-card" onclick="selectVillainForGame('captain_hook')" data-villain="captain_hook">
                    <div class="villain-icon">üè¥‚Äç‚ò†Ô∏è</div>
                    <div class="villain-name">Captain Hook</div>
                    <div class="villain-difficulty">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                </div>
                <div class="villain-card" onclick="selectVillainForGame('queen_hearts')" data-villain="queen_hearts">
                    <div class="villain-icon">üë∏</div>
                    <div class="villain-name">Queen of Hearts</div>
                    <div class="villain-difficulty">‚≠ê‚≠ê‚≠ê‚≠ê</div>
                </div>
                <div class="villain-card" onclick="selectVillainForGame('prince_john')" data-villain="prince_john">
                    <div class="villain-icon">ü§¥</div>
                    <div class="villain-name">Prince John</div>
                    <div class="villain-difficulty">‚≠ê‚≠ê‚≠ê</div>
                </div>
                <div class="villain-card coming-soon">
                    <div class="villain-icon">‚ùì</div>
                    <div class="villain-name">Bient√¥t...</div>
                    <div class="villain-difficulty">‚≠ê‚≠ê‚≠ê‚≠ê</div>
                </div>
            </div>
        </div>
        
        <div class="menu-buttons">
            <button class="menu-btn primary" onclick="startNewGame()">üéÆ Nouvelle Partie</button>
            <button class="menu-btn" onclick="startOfficialMode()">‚ö° Mode R√®gles Officielles</button>
            <button class="menu-btn" onclick="loadSavedGame()">üìÅ Charger une Partie</button>
            <button class="menu-btn" onclick="showTutorial()">üéì Tutoriel</button>
            <button class="menu-btn" onclick="showCredits()">üèÜ Cr√©dits</button>
            <button class="menu-btn" onclick="exitGame()">üö™ Quitter</button>
        </div>
    </div>

    <!-- Interface de Jeu -->
    <div class="game-interface" id="gameInterface">
        <div class="game-layout">
            <!-- Panneau Joueur -->
            <div class="player-panel">
                <div class="player-avatar">üßû‚Äç‚ôÇÔ∏è</div>
                <div class="player-name">Joueur 1</div>
                <div class="villain-name">Jafar</div>
                
                <div class="player-stats">
                    <div class="stat-item">
                        <span class="stat-label">‚ö° Pouvoir</span>
                        <span class="stat-value" id="playerPower">4</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">üÉè Cartes</span>
                        <span class="stat-value" id="handSize">4</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">üéØ Position</span>
                        <span class="stat-value" id="currentLocation">Palais</span>
                    </div>
                </div>
            </div>

            <!-- Plateau de Jeu - Structure officielle Disney Villainous -->
            <div class="game-board">
                <h2 class="board-title">üè∞ Royaume de <span id="current-villain-name">Jafar</span></h2>
                
                <!-- Zone Cartes Fatalit√© (partie sup√©rieure du royaume) -->
                <div class="fate-cards-zone">
                    <div class="zone-title">üíÄ Zone Fatalit√©</div>
                    <div class="fate-cards-container" id="fateCardsContainer">
                        <div class="empty-zone">Les adversaires placeront ici leurs cartes Fatalit√©</div>
                    </div>
                </div>
                
                <!-- Zone des 4 Lieux du Royaume -->
                <div class="locations-container">
                    <div class="location-card active" data-location="palace" onclick="selectLocation('palace')">
                        <div class="location-name">Palais du Sultan</div>
                        <div class="location-actions">
                            <div class="action-row">
                                <div class="action-icon" title="Gagner 2 Pouvoirs">üí∞</div>
                                <div class="action-icon" title="Jouer une Carte" data-blocked-by-heroes="true">üÉè</div>
                            </div>
                            <div class="action-row">
                                <div class="action-icon" title="Attaquer/Vaincre">‚öîÔ∏è</div>
                                <div class="action-icon" title="D√©fausser des Cartes">üóëÔ∏è</div>
                            </div>
                        </div>
                        <!-- Figurine du joueur -->
                        <div class="player-figure" id="playerFigure">üßû‚Äç‚ôÇÔ∏è</div>
                    </div>
                    
                    <div class="location-card" data-location="throne" onclick="selectLocation('throne')">
                        <div class="location-name">Salle du Tr√¥ne</div>
                        <div class="location-actions">
                            <div class="action-row">
                                <div class="action-icon" title="Gagner 1 Pouvoir">üí∞</div>
                                <div class="action-icon" title="Jouer une Carte">üÉè</div>
                            </div>
                            <div class="action-row">
                                <div class="action-icon" title="Activer" data-blocked-by-heroes="true">üîß</div>
                                <div class="action-icon" title="Fatalit√©">üîÆ</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="location-card" data-location="cave" onclick="selectLocation('cave')">
                        <div class="location-name">Caverne aux Merveilles</div>
                        <div class="location-actions">
                            <div class="action-row">
                                <div class="action-icon" title="Jouer une Carte" data-blocked-by-heroes="true">üÉè</div>
                                <div class="action-icon" title="Activer">ÔøΩ</div>
                            </div>
                            <div class="action-row">
                                <div class="action-icon" title="D√©fausser des Cartes">üóëÔ∏è</div>
                                <div class="action-icon" title="Gagner 3 Pouvoirs">ÔøΩ</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="location-card" data-location="chamber" onclick="selectLocation('chamber')">
                        <div class="location-name">Chambre Secr√®te</div>
                        <div class="location-actions">
                            <div class="action-row">
                                <div class="action-icon" title="Gagner 1 Pouvoir">üí∞</div>
                                <div class="action-icon" title="Jouer une Carte">üÉè</div>
                            </div>
                            <div class="action-row">
                                <div class="action-icon" title="Hypnotiser les Gardes">üëÅÔ∏è</div>
                                <div class="action-icon empty"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Zone Cartes M√©chant (partie inf√©rieure du royaume) -->
                <div class="villain-cards-zone">
                    <div class="zone-title">üé≠ Cartes M√©chant en jeu</div>
                    <div class="villain-cards-container" id="villainCardsContainer">
                        <div class="empty-zone">Vos cartes M√©chant appara√Ætront ici</div>
                    </div>
                </div>
                
                <!-- Pioches et d√©fausse -->
                <div class="decks-zone">
                    <div class="deck-pile villain-deck" onclick="drawVillainCard()" title="Pioche M√©chant">
                        <div class="deck-icon">üé≠</div>
                        <div class="deck-title">Pioche M√©chant</div>
                        <div class="deck-count" id="villainDeckCount">30</div>
                    </div>
                    <div class="deck-pile fate-deck" onclick="showFateDeck()" title="Pioche Fatalit√© (Adversaires)">
                        <div class="deck-icon">üíÄ</div>
                        <div class="deck-title">Pioche Fatalit√©</div>
                        <div class="deck-count" id="fateDeckCount">15</div>
                    </div>
                    <div class="deck-pile discard-pile" onclick="showDiscardPile()" title="D√©fausse">
                        <div class="deck-icon">üóëÔ∏è</div>
                        <div class="deck-title">D√©fausse</div>
                        <div class="deck-count" id="discardCount">0</div>
                    </div>
                </div>
            </div>

            <!-- Panneau Actions -->
            <div class="actions-panel">
                <h3 class="panel-title">Objectif</h3>
                <div class="objective-box">
                    <div class="objective-title">üéØ Condition de Victoire</div>
                    <div class="objective-text">Avoir la Lampe Magique √† la Caverne aux Merveilles et localiser Jasmine</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 25%"></div>
                    </div>
                </div>
                
                <h3 class="panel-title">Actions Disponibles</h3>
                <div class="actions-list">
                    <button class="menu-btn" onclick="gainPower()">üí∞ Gagner du Pouvoir (2)</button>
                    <button class="menu-btn" onclick="playCard()">üÉè Jouer une Carte</button>
                    <button class="menu-btn" onclick="discardCards()">üóëÔ∏è D√©fausser des Cartes</button>
                </div>
            </div>

            <!-- Main du Joueur -->
            <div class="player-hand">
                <h3 class="hand-title">üÉè Votre Main</h3>
                <div class="cards-container">
                    <div class="game-card" onclick="selectCard(this)" oncontextmenu="showCardMenu(event, this)">
                        <div class="card-cost">3</div>
                        <div class="card-image">üêç</div>
                        <div class="card-name">Serpent G√©ant</div>
                        <div class="card-description">Alli√©. Force 8. Peut vaincre les H√©ros dans n'importe quel lieu.</div>
                    </div>
                    
                    <div class="game-card" onclick="selectCard(this)" oncontextmenu="showCardMenu(event, this)">
                        <div class="card-cost">2</div>
                        <div class="card-image">üîÆ</div>
                        <div class="card-name">Hypnose</div>
                        <div class="card-description">Effet. Regardez la main d'un adversaire et choisissez une carte √† d√©fausser.</div>
                    </div>
                    
                    <div class="game-card" onclick="selectCard(this)" oncontextmenu="showCardMenu(event, this)">
                        <div class="card-cost">1</div>
                        <div class="card-image">üíé</div>
                        <div class="card-name">Bague du Pouvoir</div>
                        <div class="card-description">Objet. Gagnez +1 Pouvoir √† chaque d√©but de tour.</div>
                    </div>
                    
                    <div class="game-card" onclick="selectCard(this)" oncontextmenu="showCardMenu(event, this)">
                        <div class="card-cost">4</div>
                        <div class="card-image">üßû‚Äç‚ôÇÔ∏è</div>
                        <div class="card-name">G√©nie Corrompu</div>
                        <div class="card-description">Alli√©. Force 12. Condition: Avoir la Lampe Magique en jeu.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Menu Contextuel -->
    <div class="context-menu" id="contextMenu">
        <div class="menu-item" onclick="playSelectedCard()">üÉè Jouer la Carte</div>
        <div class="menu-item" onclick="discardSelectedCard()">üóëÔ∏è D√©fausser</div>
        <div class="menu-item" onclick="examineCard()">üîç Examiner</div>
    </div>

    <script>
        // ===== SYST√àME DE TOUR OFFICIEL DISNEY VILLAINOUS =====
        
        // √âtat du jeu selon les r√®gles officielles
        let gameState = {
            currentPlayer: 'Jafar',
            turnNumber: 1,
            playerPower: 4,
            currentLocation: 'palace',
            gameStartTime: Date.now(),
            selectedCard: null,
            phase: 'move', // 'move', 'actions', 'draw', 'discard'
            actionsRemaining: 0,
            handLimit: 4,
            maxHandSize: 7
        };

        // S√©quence officielle d'un tour
        const TURN_PHASES = {
            MOVE: {
                name: 'D√©placement',
                description: 'D√©placez votre figurine vers un lieu adjacent',
                icon: 'üö∂‚Äç‚ôÇÔ∏è',
                mandatory: true
            },
            ACTIONS: {
                name: 'Actions',
                description: 'Effectuez toutes les actions du lieu (dans l\'ordre de votre choix)',
                icon: '‚ö°',
                mandatory: true
            },
            DRAW: {
                name: 'Piocher',
                description: 'Piochez jusqu\'√† avoir 4 cartes en main',
                icon: 'üÉè',
                mandatory: true
            },
            DISCARD: {
                name: 'D√©fausser',
                description: 'Si vous avez plus de 7 cartes, d√©faussez l\'exc√©dent',
                icon: 'üóëÔ∏è',
                mandatory: false
            }
        };

        // D√©marrer un nouveau tour selon les r√®gles officielles
        function startTurn() {
            console.log(`üéØ D√©but du tour ${gameState.turnNumber} - ${gameState.currentPlayer}`);
            
            // Phase 1: D√©placement obligatoire
            gameState.phase = 'move';
            updateTurnDisplay();
            showAvailableMovements();
            
            // R√©initialiser les actions
            gameState.actionsRemaining = 0;
            
            // Animation d'entr√©e de tour
            animateTurnStart();
        }

        // D√©placement vers un lieu adjacent
        function moveToLocation(locationId) {
            if (gameState.phase !== 'move') {
                showMessage('Vous devez d\'abord vous d√©placer !', 'warning');
                return;
            }

            const currentLocationElement = document.querySelector('.location-card.active');
            const newLocationElement = document.querySelector(`[data-location="${locationId}"]`);
            
            if (!newLocationElement) return;

            // V√©rifier si le mouvement est valide (lieu adjacent)
            if (!isAdjacentLocation(gameState.currentLocation, locationId)) {
                showMessage('Vous ne pouvez vous d√©placer que vers un lieu adjacent !', 'warning');
                return;
            }

            // Effectuer le d√©placement
            if (currentLocationElement) {
                currentLocationElement.classList.remove('active');
                // Retirer la figurine
                const oldFigure = currentLocationElement.querySelector('.player-figure');
                if (oldFigure) oldFigure.style.display = 'none';
            }

            newLocationElement.classList.add('active');
            gameState.currentLocation = locationId;
            
            // Placer la figurine
            let figure = newLocationElement.querySelector('.player-figure');
            if (!figure) {
                figure = document.createElement('div');
                figure.className = 'player-figure';
                figure.innerHTML = 'üßû‚Äç‚ôÇÔ∏è';
                newLocationElement.appendChild(figure);
            }
            figure.style.display = 'block';

            // Animation du d√©placement
            animateMovement(newLocationElement);

            // Passer √† la phase d'actions
            setTimeout(() => {
                gameState.phase = 'actions';
                startActionsPhase(locationId);
            }, 500);
        }

        // V√©rifier si deux lieux sont adjacents
        function isAdjacentLocation(currentLoc, newLoc) {
            const locations = ['palace', 'throne', 'cave', 'chamber'];
            const currentIndex = locations.indexOf(currentLoc);
            const newIndex = locations.indexOf(newLoc);
            
            // Adjacent = diff√©rence d'index de ¬±1 (avec wrap-around)
            const diff = Math.abs(currentIndex - newIndex);
            return diff === 1 || diff === 3; // 3 pour le wrap-around (premier/dernier)
        }

        // Phase d'actions selon les r√®gles officielles
        function startActionsPhase(locationId) {
            const location = VILLAINS[gameState.currentPlayer].board.find(loc => loc.id === locationId);
            if (!location) return;

            console.log(`‚ö° Phase d'actions au lieu: ${location.name}`);
            
            // Compter les actions disponibles (non bloqu√©es par les H√©ros)
            const availableActions = location.actions.filter(action => {
                return !action.blockedByHeroes || !hasHeroesAtLocation(locationId);
            });

            gameState.actionsRemaining = availableActions.length;
            updateTurnDisplay();
            highlightAvailableActions(locationId);
            
            showMessage(`Vous pouvez effectuer ${gameState.actionsRemaining} actions dans ce lieu`, 'info');
        }

        // ===== M√âCANIQUES SP√âCIFIQUES PAR M√âCHANT =====
        
        // Maleficent - Maudire l'Aurore
        function curse_spell(location) {
            if (!location || location.id === 'forbidden_mountain') {
                showNotification("‚ö†Ô∏è Aurora ne peut pas √™tre maudite √† la Montagne Interdite", "error");
                return false;
            }
            
            // Ajouter le marqueur de mal√©diction
            const curseMarker = document.createElement('div');
            curseMarker.className = 'curse-marker';
            curseMarker.innerHTML = 'üîÆ';
            curseMarker.title = 'Mal√©diction de Mal√©fique';
            location.element.style.position = 'relative';
            location.element.appendChild(curseMarker);
            
            // Mettre √† jour l'√©tat du jeu
            gameState.specialMechanics.cursedLocation = location.id;
            gameState.power += 2; // Bonus de pouvoir
            
            showNotification("‚ú® Aurora a √©t√© maudite ! +2 Pouvoir", "success");
            updateDisplay();
            return true;
        }

        // Captain Hook - Abordage
        function boarding_party(ally, enemy) {
            if (!ally || !enemy) {
                showNotification("‚ö†Ô∏è S√©lectionnez un alli√© et un ennemi", "error");
                return false;
            }
            
            // D√©placer l'alli√© vers l'ennemi
            moveAllyToEnemy(ally, enemy);
            
            // Bonus temporaire d'abordage
            ally.element.classList.add('boarding-bonus');
            setTimeout(() => {
                ally.element.classList.remove('boarding-bonus');
            }, 3000);
            
            gameState.power += 1; // Bonus de pouvoir
            showNotification("‚öîÔ∏è Abordage r√©ussi ! L'alli√© attaque", "success");
            updateDisplay();
            return true;
        }

        // Jafar - Hypnotiser les gardes
        function hypnotize_guards(location) {
            if (!location) {
                showNotification("‚ö†Ô∏è S√©lectionnez un lieu", "error");
                return false;
            }
            
            // Contr√¥ler temporairement le lieu
            location.controlled = true;
            location.element.style.border = '3px solid #9932CC';
            
            // Effet temporaire (3 tours)
            gameState.specialMechanics.hypnotizedLocation = {
                locationId: location.id,
                turnsRemaining: 3
            };
            
            gameState.power += 1;
            showNotification("üêç Gardes hypnotis√©s ! Lieu contr√¥l√©", "success");
            updateDisplay();
            return true;
        }

        // D√©placer alli√© vers ennemi (pour Captain Hook)
        function moveAllyToEnemy(ally, enemy) {
            const enemyLocation = findLocationById(enemy.locationId);
            if (enemyLocation) {
                ally.locationId = enemy.locationId;
                ally.element.classList.add('moved-item');
                setTimeout(() => {
                    ally.element.classList.remove('moved-item');
                }, 2000);
            }
        }

        // Trouver lieu par ID
        function findLocationById(locationId) {
            return gameState.currentVillain.locations.find(loc => loc.id === locationId);
        }

        // D√©compte des effets temporaires
        function updateTemporaryEffects() {
            // Hypnose de Jafar
            if (gameState.specialMechanics.hypnotizedLocation) {
                gameState.specialMechanics.hypnotizedLocation.turnsRemaining--;
                
                if (gameState.specialMechanics.hypnotizedLocation.turnsRemaining <= 0) {
                    const location = findLocationById(gameState.specialMechanics.hypnotizedLocation.locationId);
                    if (location) {
                        location.controlled = false;
                        location.element.style.border = '';
                    }
                    delete gameState.specialMechanics.hypnotizedLocation;
                    showNotification("üïê L'hypnose s'estompe", "info");
                }
            }
        }

        // V√©rification des conditions de victoire sp√©cifiques
        function checkVillainSpecificVictory() {
            const villain = gameState.currentVillain;
            
            switch(villain.name) {
                case 'Maleficent':
                    return checkMaleficentVictory();
                case 'Captain Hook':
                    return checkCaptainHookVictory();
                case 'Jafar':
                    return checkJafarVictory();
                default:
                    return false;
            }
        }

        function checkMaleficentVictory() {
            // Aurore doit √™tre maudite et √† la Ronce √âpineuse
            return gameState.specialMechanics.cursedLocation && 
                   gameState.specialMechanics.cursedLocation === 'the_briar_rose' &&
                   gameState.power >= 15;
        }

        function checkCaptainHookVictory() {
            // Peter Pan doit √™tre vaincu au Jolly Roger
            return gameState.specialMechanics.peterPanDefeated && 
                   gameState.power >= 12;
        }

        function checkJafarVictory() {
            // G√©nie contr√¥l√© et Sultan hypnotis√©
            return gameState.specialMechanics.genieControlled && 
                   gameState.specialMechanics.sultanHypnotized &&
                   gameState.power >= 10;
        }

        // Effectuer une action sp√©cifique selon les r√®gles officielles
        function performAction(actionType, actionData) {
            if (gameState.phase !== 'actions' || gameState.actionsRemaining <= 0) {
                showMessage('Aucune action disponible !', 'warning');
                return;
            }

            console.log(`üé¨ Action: ${actionType}`, actionData);

            switch (actionType) {
                case 'gain_power':
                    gameState.playerPower += actionData.value;
                    showMessage(`+${actionData.value} Pouvoir ! Total: ${gameState.playerPower}`, 'success');
                    updatePowerDisplay();
                    break;

                case 'play_card':
                    showPlayCardDialog();
                    break;

                case 'vanquish':
                    showVanquishDialog();
                    break;

                case 'discard':
                    showDiscardDialog();
                    break;

                case 'activate':
                    showActivateDialog();
                    break;

                case 'fate':
                    performFateAction();
                    break;

                case 'curse_spell':
                    performCurseSpell();
                    break;

                case 'boarding_party':
                    performBoardingParty();
                    break;

                case 'move_item':
                    showMoveItemDialog();
                    break;

                case 'hypnotize_guards':
                    performHypnotizeGuards();
                    break;

                default:
                    showMessage(`Action ${actionType} non impl√©ment√©e`, 'warning');
            }

            // D√©cr√©menter les actions restantes
            gameState.actionsRemaining--;
            updateOfficialTurnDisplay();

            // Si toutes les actions sont effectu√©es, passer √† la phase de pioche
            if (gameState.actionsRemaining <= 0) {
                setTimeout(() => {
                    gameState.phase = 'draw';
                    startDrawPhase();
                }, 1000);
            }
        }

        // Action sp√©ciale Maleficent : Placer une Mal√©diction
        function performCurseSpell() {
            console.log('üü£ Action: Placer une Mal√©diction');
            
            if (gameState.playerPower < 3) {
                showMessage('Pas assez de Pouvoir pour placer une Mal√©diction ! (Co√ªt: 3)', 'warning');
                return;
            }

            const currentVillain = VILLAINS[gameState.currentPlayer.toLowerCase()];
            if (currentVillain && currentVillain.specialMechanic === 'curse_placement') {
                const currentLocationData = currentVillain.board.find(loc => loc.id === gameState.currentLocation);
                
                if (currentLocationData && !currentLocationData.cursed) {
                    // Placer la mal√©diction
                    gameState.playerPower -= 3;
                    currentLocationData.cursed = true;
                    
                    // Mise √† jour visuelle
                    const locationElement = document.querySelector(`[data-location="${gameState.currentLocation}"]`);
                    if (locationElement) {
                        const curseElement = document.createElement('div');
                        curseElement.className = 'curse-marker';
                        curseElement.innerHTML = 'üü£';
                        curseElement.style.cssText = `
                            position: absolute;
                            top: -10px;
                            right: -10px;
                            font-size: 1.5rem;
                            z-index: 10;
                            animation: curse-glow 2s infinite alternate;
                        `;
                        locationElement.appendChild(curseElement);
                    }
                    
                    updatePowerDisplay();
                    showMessage(`Mal√©diction plac√©e sur ${currentLocationData.name} !`, 'success');
                    
                    // V√©rifier condition de victoire
                    checkMaleficentVictory();
                } else if (currentLocationData && currentLocationData.cursed) {
                    showMessage('Ce lieu est d√©j√† maudit !', 'warning');
                } else {
                    showMessage('Impossible de placer une mal√©diction ici', 'error');
                }
            }
        }

        // Action sp√©ciale Captain Hook : Groupe d'Abordage
        function performBoardingParty() {
            console.log('üè¥‚Äç‚ò†Ô∏è Action: Groupe d\'Abordage');
            
            if (gameState.currentLocation === 'jolly_roger') {
                showMessage('Tous vos Alli√©s au Jolly Roger gagnent +2 Force ce tour !', 'success');
                
                // Appliquer le bonus aux alli√©s pr√©sents
                const allies = document.querySelectorAll('.villain-cards-container .game-card');
                allies.forEach(ally => {
                    const strengthElement = ally.querySelector('.card-strength');
                    if (strengthElement) {
                        const currentStrength = parseInt(strengthElement.textContent.replace('üí™ ', ''));
                        strengthElement.textContent = `üí™ ${currentStrength + 2}`;
                        ally.classList.add('boarding-bonus');
                    }
                });
            } else {
                showMessage('Cette action n\'est disponible qu\'au Jolly Roger !', 'warning');
            }
        }

        // Action sp√©ciale Jafar : Hypnotiser les Gardes
        function performHypnotizeGuards() {
            console.log('üëÅÔ∏è Action: Hypnotiser les Gardes');
            
            showMessage('Regardez la main d\'un adversaire et choisissez une carte √† d√©fausser', 'info');
            
            // Simuler l'effet pour l'instant
            setTimeout(() => {
                showMessage('Les gardes sont sous votre contr√¥le ! Un adversaire d√©fausse une carte.', 'success');
            }, 1500);
        }

        // D√©placer un objet entre les lieux
        function showMoveItemDialog() {
            const items = document.querySelectorAll('.villain-cards-container .game-card');
            const movableItems = Array.from(items).filter(item => {
                const cardName = item.querySelector('.card-name').textContent;
                return cardName.includes('Objet') || cardName.includes('Item') || 
                       cardName.includes('Crochet') || cardName.includes('Canon');
            });

            if (movableItems.length === 0) {
                showMessage('Aucun objet √† d√©placer !', 'warning');
                return;
            }

            let itemOptions = '';
            movableItems.forEach((item, index) => {
                const itemName = item.querySelector('.card-name').textContent;
                itemOptions += `
                    <div class="item-option" onclick="selectItemToMove('${item.dataset.cardId}')">
                        üì¶ ${itemName}
                    </div>
                `;
            });

            const modal = createModal('D√©placer un Objet', `
                <div class="move-item-dialog">
                    <p>Choisissez un objet √† d√©placer vers un autre lieu :</p>
                    <div class="item-options">
                        ${itemOptions}
                    </div>
                </div>
            `);
            showModal(modal);
        }

        function selectItemToMove(itemId) {
            gameState.selectedItemToMove = itemId;
            closeModal();
            
            const locations = ['palace', 'throne', 'cave', 'chamber'];
            let locationOptions = '';
            
            locations.forEach(loc => {
                if (loc !== gameState.currentLocation) {
                    const locationElement = document.querySelector(`[data-location="${loc}"]`);
                    const locationName = locationElement ? locationElement.querySelector('.location-name').textContent : loc;
                    locationOptions += `
                        <div class="location-option" onclick="moveItemToLocation('${loc}')">
                            üè∞ ${locationName}
                        </div>
                    `;
                }
            });

            const modal = createModal('Destination de l\'Objet', `
                <div class="move-destination-dialog">
                    <p>Choisissez le lieu de destination :</p>
                    <div class="location-options">
                        ${locationOptions}
                    </div>
                </div>
            `);
            showModal(modal);
        }

        function moveItemToLocation(targetLocation) {
            const itemElement = document.querySelector(`[data-card-id="${gameState.selectedItemToMove}"]`);
            if (itemElement) {
                const itemName = itemElement.querySelector('.card-name').textContent;
                const targetLocationElement = document.querySelector(`[data-location="${targetLocation}"]`);
                const targetLocationName = targetLocationElement ? targetLocationElement.querySelector('.location-name').textContent : targetLocation;
                
                // Effet visuel : l'objet se d√©place
                showMessage(`${itemName} d√©plac√© vers ${targetLocationName} !`, 'success');
                
                // Marquer l'objet comme d√©plac√©
                itemElement.classList.add('moved-item');
                itemElement.dataset.location = targetLocation;
            }
            
            closeModal();
            delete gameState.selectedItemToMove;
        }

        // V√©rifier la condition de victoire de Maleficent
        function checkMaleficentVictory() {
            if (gameState.currentPlayer.toLowerCase() !== 'maleficent') return false;
            
            const currentVillain = VILLAINS.maleficent;
            const cursedLocations = currentVillain.board.filter(loc => loc.cursed).length;
            const totalLocations = currentVillain.board.length;
            
            if (cursedLocations === totalLocations) {
                setTimeout(() => {
                    showVictoryScreen();
                }, 1000);
                return true;
            }
            
            // Mettre √† jour le progr√®s
            const progressPercent = (cursedLocations / totalLocations) * 100;
            const progressBar = document.querySelector('.progress-fill');
            if (progressBar) {
                progressBar.style.width = progressPercent + '%';
            }
            
            showMessage(`Mal√©dictions plac√©es: ${cursedLocations}/${totalLocations}`, 'info');
            return false;
        }

        // Phase de pioche obligatoire
        function startDrawPhase() {
            console.log('üÉè Phase de pioche');
            const currentHandSize = getCurrentHandSize();
            const cardsToDraw = Math.max(0, gameState.handLimit - currentHandSize);

            if (cardsToDraw > 0) {
                drawCards(cardsToDraw);
                showMessage(`Vous piochez ${cardsToDraw} carte(s)`, 'info');
            } else {
                showMessage('Votre main est d√©j√† pleine', 'info');
            }

            // V√©rifier si d√©fausse n√©cessaire
            setTimeout(() => {
                const finalHandSize = getCurrentHandSize();
                if (finalHandSize > gameState.maxHandSize) {
                    gameState.phase = 'discard';
                    startDiscardPhase();
                } else {
                    endTurn();
                }
            }, 1500);
        }

        // Phase de d√©fausse si n√©cessaire
        function startDiscardPhase() {
            console.log('üóëÔ∏è Phase de d√©fausse');
            const handSize = getCurrentHandSize();
            const cardsToDiscard = handSize - gameState.maxHandSize;

            showMessage(`Vous devez d√©fausser ${cardsToDiscard} carte(s)`, 'warning');
            showDiscardDialog(cardsToDiscard);
        }

        // Terminer le tour
        function endTurn() {
            console.log('‚úÖ Fin du tour');
            
            // V√©rifier les conditions de victoire
            if (checkVictoryConditions()) {
                showVictoryScreen();
                return;
            }

            // Passer au tour suivant
            gameState.turnNumber++;
            
            // Animation de fin de tour
            animateTurnEnd();
            
            // D√©marrer le nouveau tour apr√®s un d√©lai
            setTimeout(() => {
                startTurn();
            }, 2000);
        }

        // Fonctions utilitaires
        function updateTurnDisplay() {
            const phaseInfo = TURN_PHASES[gameState.phase.toUpperCase()];
            const turnDisplay = document.getElementById('currentPhase') || createTurnDisplay();
            
            turnDisplay.innerHTML = `
                <div class="turn-info">
                    <div class="turn-number">Tour ${gameState.turnNumber}</div>
                    <div class="phase-current">${phaseInfo.icon} ${phaseInfo.name}</div>
                    <div class="phase-description">${phaseInfo.description}</div>
                    ${gameState.actionsRemaining > 0 ? `<div class="actions-remaining">Actions: ${gameState.actionsRemaining}</div>` : ''}
                </div>
            `;
        }

        function createTurnDisplay() {
            const display = document.createElement('div');
            display.id = 'currentPhase';
            display.className = 'turn-display';
            document.querySelector('.player-panel').appendChild(display);
            return display;
        }

        function showAvailableMovements() {
            const locations = document.querySelectorAll('.location-card');
            locations.forEach(loc => {
                const locationId = loc.dataset.location;
                if (isAdjacentLocation(gameState.currentLocation, locationId) && locationId !== gameState.currentLocation) {
                    loc.classList.add('available-movement');
                    loc.style.border = '3px solid #00FF00';
                } else {
                    loc.classList.remove('available-movement');
                }
            });
        }

        function animateMovement(locationElement) {
            locationElement.style.transform = 'scale(1.1)';
            setTimeout(() => {
                locationElement.style.transform = 'scale(1)';
            }, 300);
        }

        function animateTurnStart() {
            document.body.classList.add('turn-start-animation');
            setTimeout(() => {
                document.body.classList.remove('turn-start-animation');
            }, 1000);
        }

        function animateTurnEnd() {
            document.body.classList.add('turn-end-animation');
            setTimeout(() => {
                document.body.classList.remove('turn-end-animation');
            }, 1000);
        }

        // ===== GESTION DES CARTES SELON LES R√àGLES OFFICIELLES =====
        
        // Types de cartes M√©chant
        const VILLAIN_CARD_TYPES = {
            ALLY: { name: 'Alli√©', icon: 'üõ°Ô∏è', color: '#4CAF50' },
            ITEM: { name: 'Objet', icon: '‚öîÔ∏è', color: '#FF9800' },
            EFFECT: { name: 'Effet', icon: '‚ú®', color: '#9C27B0' },
            CONDITION: { name: 'Condition', icon: 'üéØ', color: '#2196F3' }
        };

        // Types de cartes Fatalit√©
        const FATE_CARD_TYPES = {
            HERO: { name: 'H√©ros', icon: 'ü¶∏‚Äç‚ôÇÔ∏è', color: '#F44336' },
            ITEM: { name: 'Objet', icon: 'üõ°Ô∏è', color: '#FF5722' },
            EFFECT: { name: 'Effet', icon: 'üí´', color: '#E91E63' }
        };

        // Piocher des cartes M√©chant
        function drawCards(count) {
            for (let i = 0; i < count; i++) {
                drawVillainCard();
            }
        }

        function drawVillainCard() {
            const deckCount = parseInt(document.getElementById('villainDeckCount').textContent);
            if (deckCount <= 0) {
                reshuffleVillainDeck();
                return;
            }

            // Cr√©er une nouvelle carte
            const card = generateVillainCard();
            addCardToHand(card);
            
            // Mettre √† jour le compteur
            document.getElementById('villainDeckCount').textContent = deckCount - 1;
            
            // Animation de pioche
            animateCardDraw(card);
        }

        // G√©n√©rer une carte M√©chant al√©atoire
        function generateVillainCard() {
            const villainData = VILLAINS[gameState.currentPlayer];
            const cardTypes = Object.keys(VILLAIN_CARD_TYPES);
            const type = cardTypes[Math.floor(Math.random() * cardTypes.length)];
            
            const cards = {
                jafar: {
                    ALLY: [
                        { name: 'Serpent G√©ant', cost: 3, strength: 8, description: 'Peut vaincre les H√©ros dans n\'importe quel lieu' },
                        { name: 'Gardes du Palais', cost: 2, strength: 5, description: 'D√©fenseurs du Palais du Sultan' },
                        { name: 'G√©nie Corrompu', cost: 5, strength: 12, description: 'Condition: Avoir la Lampe Magique' }
                    ],
                    ITEM: [
                        { name: 'Lampe Magique', cost: 4, description: 'Objet de victoire. Doit √™tre √† la Caverne aux Merveilles' },
                        { name: 'B√¢ton du Serpent', cost: 2, description: '+2 Force √† tous vos Alli√©s' },
                        { name: 'Anneau de Pouvoir', cost: 1, description: '+1 Pouvoir au d√©but de chaque tour' }
                    ],
                    EFFECT: [
                        { name: 'Hypnose', cost: 2, description: 'Regardez la main d\'un adversaire et choisissez une carte √† d√©fausser' },
                        { name: 'Sables Mouvants', cost: 1, description: 'D√©placez un H√©ros vers un autre lieu' },
                        { name: 'Illusion', cost: 3, description: 'Jouez cette carte comme si c\'√©tait n\'importe quelle autre carte' }
                    ],
                    CONDITION: [
                        { name: 'Localiser Jasmine', cost: 2, description: 'Condition de victoire. Doit √™tre jou√© quand vous avez la Lampe' },
                        { name: 'Contr√¥le du Palais', cost: 3, description: 'Aucun H√©ros ne peut √™tre jou√© au Palais du Sultan' }
                    ]
                }
            };

            const availableCards = cards[gameState.currentPlayer][type] || [];
            const card = availableCards[Math.floor(Math.random() * availableCards.length)];
            
            return {
                ...card,
                type: type,
                typeInfo: VILLAIN_CARD_TYPES[type],
                id: `card_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`
            };
        }

        // Ajouter une carte √† la main
        function addCardToHand(card) {
            const handContainer = document.querySelector('.cards-container');
            const cardElement = createCardElement(card);
            handContainer.appendChild(cardElement);
            updateHandSizeDisplay();
        }

        // Cr√©er l'√©l√©ment visuel d'une carte
        function createCardElement(card) {
            const cardDiv = document.createElement('div');
            cardDiv.className = 'game-card villain-card';
            cardDiv.dataset.cardId = card.id;
            cardDiv.onclick = () => selectCard(cardDiv);
            cardDiv.oncontextmenu = (e) => showCardMenu(e, cardDiv);
            
            cardDiv.innerHTML = `
                <div class="card-cost">${card.cost}</div>
                <div class="card-type" style="background: ${card.typeInfo.color}">
                    ${card.typeInfo.icon} ${card.typeInfo.name}
                </div>
                <div class="card-image">${getCardIcon(card)}</div>
                <div class="card-name">${card.name}</div>
                <div class="card-description">${card.description}</div>
                ${card.strength ? `<div class="card-strength">üí™ ${card.strength}</div>` : ''}
            `;
            
            return cardDiv;
        }

        function getCardIcon(card) {
            const icons = {
                'Serpent G√©ant': 'üêç',
                'Lampe Magique': 'ü™î',
                'Hypnose': 'üîÆ',
                'G√©nie Corrompu': 'üßû‚Äç‚ôÇÔ∏è',
                'Gardes du Palais': '‚öîÔ∏è',
                'B√¢ton du Serpent': 'üêç',
                'Anneau de Pouvoir': 'üíç',
                'Sables Mouvants': 'üèúÔ∏è',
                'Illusion': '‚ú®',
                'Localiser Jasmine': 'üë∏',
                'Contr√¥le du Palais': 'üè∞'
            };
            return icons[card.name] || card.typeInfo.icon;
        }

        // Action Fatalit√©
        function performFateAction() {
            console.log('üîÆ Action Fatalit√©');
            
            // Montrer les adversaires disponibles
            showFateTargetDialog();
        }

        function showFateTargetDialog() {
            const modal = createModal('Choisir la cible de la Fatalit√©', `
                <div class="fate-targets">
                    <p>Choisissez un adversaire pour lui infliger une Fatalit√© :</p>
                    <div class="target-list">
                        <div class="target-option" onclick="applyFateToPlayer('maleficent')">
                            <div class="target-avatar">üßô‚Äç‚ôÄÔ∏è</div>
                            <div class="target-name">Maleficent</div>
                        </div>
                        <div class="target-option" onclick="applyFateToPlayer('captain_hook')">
                            <div class="target-avatar">üè¥‚Äç‚ò†Ô∏è</div>
                            <div class="target-name">Captain Hook</div>
                        </div>
                    </div>
                </div>
            `);
            showModal(modal);
        }

        function applyFateToPlayer(targetPlayer) {
            closeModal();
            
            // Piocher une carte Fatalit√©
            const fateCard = drawFateCard(targetPlayer);
            
            // L'appliquer au joueur cible
            applyFateCard(targetPlayer, fateCard);
            
            showMessage(`Fatalit√© appliqu√©e √† ${targetPlayer} : ${fateCard.name}`, 'success');
        }

        function drawFateCard(targetPlayer) {
            // Cartes Fatalit√© pour Jafar (quand on lui applique une Fatalit√©)
            const fateCards = {
                jafar: [
                    { name: 'Aladdin', type: 'HERO', strength: 10, description: 'Bloque les actions "Jouer une Carte" au Palais' },
                    { name: 'Jasmine', type: 'HERO', strength: 8, description: 'Emp√™che de gagner tant qu\'elle est en jeu' },
                    { name: 'G√©nie d\'Aladdin', type: 'HERO', strength: 12, description: 'Peut vaincre n\'importe quel Alli√©' },
                    { name: '√âp√©e d\'Aladdin', type: 'ITEM', description: 'Aladdin gagne +5 Force' },
                    { name: 'Vol de Tapis', type: 'EFFECT', description: 'D√©placez Aladdin vers n\'importe quel lieu' }
                ]
            };

            const availableCards = fateCards[targetPlayer] || fateCards.jafar;
            return availableCards[Math.floor(Math.random() * availableCards.length)];
        }

        function applyFateCard(targetPlayer, fateCard) {
            // Si c'est un H√©ros, le placer sur le plateau
            if (fateCard.type === 'HERO') {
                placeHeroOnBoard(fateCard, targetPlayer);
            }
            
            // Mettre √† jour l'affichage des cartes Fatalit√©
            updateFateCardsDisplay(targetPlayer, fateCard);
        }

        function placeHeroOnBoard(hero, targetPlayer) {
            // Placer le H√©ros sur un lieu al√©atoire du plateau du joueur cible
            const locations = ['palace', 'throne', 'cave', 'chamber'];
            const randomLocation = locations[Math.floor(Math.random() * locations.length)];
            
            const locationElement = document.querySelector(`[data-location="${randomLocation}"]`);
            if (locationElement) {
                // Cr√©er l'√©l√©ment H√©ros
                const heroElement = document.createElement('div');
                heroElement.className = 'hero-card';
                heroElement.innerHTML = `
                    <div class="hero-name">${hero.name}</div>
                    <div class="hero-strength">üí™ ${hero.strength}</div>
                `;
                
                // Ajouter au lieu
                locationElement.appendChild(heroElement);
                
                // Bloquer les actions si n√©cessaire
                if (hero.description.includes('Bloque')) {
                    blockActionsAtLocation(randomLocation, hero.name);
                }
            }
        }

        function blockActionsAtLocation(locationId, heroName) {
            const locationElement = document.querySelector(`[data-location="${locationId}"]`);
            const blockedActions = locationElement.querySelectorAll('[data-blocked-by-heroes="true"]');
            
            blockedActions.forEach(action => {
                action.classList.add('blocked-by-hero');
                action.title = `Bloqu√© par ${heroName}`;
            });
        }

        // Fonctions utilitaires
        function getCurrentHandSize() {
            return document.querySelectorAll('.cards-container .game-card').length;
        }

        function updateHandSizeDisplay() {
            const handSize = getCurrentHandSize();
            document.getElementById('handSize').textContent = handSize;
        }

        function updatePowerDisplay() {
            document.getElementById('playerPower').textContent = gameState.playerPower;
        }

        function hasHeroesAtLocation(locationId) {
            const locationElement = document.querySelector(`[data-location="${locationId}"]`);
            return locationElement.querySelector('.hero-card') !== null;
        }

        function reshuffleVillainDeck() {
            // M√©langer la d√©fausse dans la pioche
            const discardCount = parseInt(document.getElementById('discardCount').textContent);
            document.getElementById('villainDeckCount').textContent = discardCount;
            document.getElementById('discardCount').textContent = '0';
            
            showMessage('Pioche recharg√©e depuis la d√©fausse !', 'info');
        }

        function animateCardDraw(card) {
            // Animation de carte qui vient de la pioche vers la main
            const deckElement = document.querySelector('.villain-deck');
            const handElement = document.querySelector('.cards-container');
            
            if (deckElement && handElement) {
                const flyingCard = document.createElement('div');
                flyingCard.className = 'flying-card';
                flyingCard.innerHTML = 'üÉè';
                
                const deckRect = deckElement.getBoundingClientRect();
                const handRect = handElement.getBoundingClientRect();
                
                flyingCard.style.cssText = `
                    position: fixed;
                    left: ${deckRect.left}px;
                    top: ${deckRect.top}px;
                    z-index: 1000;
                    font-size: 2rem;
                    transition: all 0.6s ease;
                    pointer-events: none;
                `;
                
                document.body.appendChild(flyingCard);
                
                setTimeout(() => {
                    flyingCard.style.left = handRect.right - 50 + 'px';
                    flyingCard.style.top = handRect.top + 'px';
                    flyingCard.style.transform = 'scale(0.3)';
                    flyingCard.style.opacity = '0';
                }, 100);
                
                setTimeout(() => {
                    document.body.removeChild(flyingCard);
                }, 700);
            }
        }

        // ===== DONN√âES DES M√âCHANTS DISNEY VILLAINOUS =====
        
        // ===== CARTES SP√âCIFIQUES PAR M√âCHANT =====
        const VILLAIN_CARDS = {
            'Maleficent': {
                villain: [
                    { id: 'forest_of_thorns', name: 'For√™t de Ronces', cost: 3, type: 'condition', effect: 'Bloque les h√©ros' },
                    { id: 'maleficent_spell', name: 'Mal√©diction', cost: 2, type: 'spell', effect: 'Maudit Aurora' },
                    { id: 'ravens', name: 'Corbeaux', cost: 1, type: 'ally', power: 2, effect: 'Reconnaissance' },
                    { id: 'distaff', name: 'Quenouille', cost: 4, type: 'item', effect: 'Endort Aurora' },
                    { id: 'green_fire', name: 'Feu Vert', cost: 2, type: 'spell', effect: '+3 Pouvoir ce tour' }
                ],
                fate: [
                    { id: 'aurora', name: 'Aurore', type: 'hero', power: 4, effect: 'R√©siste aux mal√©dictions' },
                    { id: 'three_fairies', name: 'Trois F√©es', type: 'hero', power: 3, effect: 'Prot√®ge Aurora' },
                    { id: 'prince_phillip', name: 'Prince Philippe', type: 'hero', power: 5, effect: '√âp√©e magique' },
                    { id: 'sword_of_truth', name: '√âp√©e de V√©rit√©', type: 'item', effect: 'D√©truit les sorts' }
                ]
            },
            'Captain Hook': {
                villain: [
                    { id: 'jolly_roger', name: 'Jolly Roger', cost: 4, type: 'location', effect: 'Navire principal' },
                    { id: 'smee', name: 'Mouche', cost: 2, type: 'ally', power: 2, effect: 'Loyal serviteur' },
                    { id: 'pirates', name: 'Pirates', cost: 3, type: 'ally', power: 3, effect: 'Abordage' },
                    { id: 'hook_sword', name: '√âp√©e de Hook', cost: 2, type: 'item', effect: '+2 au combat' },
                    { id: 'cannon_blast', name: 'Tir de Canon', cost: 3, type: 'spell', effect: 'D√©g√¢ts √† distance' }
                ],
                fate: [
                    { id: 'peter_pan', name: 'Peter Pan', type: 'hero', power: 5, effect: 'Vol et esquive' },
                    { id: 'tinker_bell', name: 'F√©e Clochette', type: 'hero', power: 2, effect: 'Soigne Peter Pan' },
                    { id: 'wendy', name: 'Wendy', type: 'hero', power: 2, effect: 'Inspire courage' },
                    { id: 'crocodile', name: 'Crocodile', type: 'effect', effect: 'Effraie Hook' }
                ]
            },
            'Jafar': {
                villain: [
                    { id: 'hypnotize', name: 'Hypnose', cost: 2, type: 'spell', effect: 'Contr√¥le un ennemi' },
                    { id: 'scarab_beetle', name: 'Scarab√©e', cost: 1, type: 'ally', power: 1, effect: 'Espionnage' },
                    { id: 'snake_staff', name: 'B√¢ton Serpent', cost: 3, type: 'item', effect: 'Transformation' },
                    { id: 'lamp_search', name: 'Recherche Lampe', cost: 2, type: 'spell', effect: 'Pioche 2 cartes' },
                    { id: 'iago', name: 'Iago', cost: 2, type: 'ally', power: 2, effect: 'Imite les voix' }
                ],
                fate: [
                    { id: 'aladdin', name: 'Aladdin', type: 'hero', power: 4, effect: 'Agilit√© et ruse' },
                    { id: 'genie', name: 'G√©nie', type: 'hero', power: 6, effect: 'Trois v≈ìux' },
                    { id: 'jasmine', name: 'Jasmine', type: 'hero', power: 3, effect: 'Fi√®re princesse' },
                    { id: 'abu', name: 'Abu', type: 'ally', power: 1, effect: 'Vol √† la tire' }
                ]
            }
        };

        // M√©langer et distribuer les cartes
        function shuffleDeck(cards) {
            const shuffled = [...cards];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // Piocher une carte
        function drawCard(deckType = 'villain') {
            const villain = gameState.currentVillain;
            const deck = deckType === 'villain' ? villain.villainDeck : villain.fateDeck;
            
            if (deck.length === 0) {
                showNotification("üÉè Le deck est vide !", "warning");
                return null;
            }
            
            const card = deck.pop();
            gameState.hand.push(card);
            updateDisplay();
            
            showNotification(`üìã Carte pioch√©e : ${card.name}`, "info");
            return card;
        }

        // Jouer une carte
        function playCard(cardId) {
            const cardIndex = gameState.hand.findIndex(card => card.id === cardId);
            if (cardIndex === -1) {
                showNotification("‚ùå Carte introuvable !", "error");
                return false;
            }
            
            const card = gameState.hand[cardIndex];
            
            // V√©rifier le co√ªt
            if (card.cost && gameState.power < card.cost) {
                showNotification(`üí∞ Pas assez de pouvoir (${card.cost} requis)`, "warning");
                return false;
            }
            
            // Payer le co√ªt
            if (card.cost) {
                gameState.power -= card.cost;
            }
            
            // Appliquer l'effet
            applyCardEffect(card);
            
            // Retirer de la main
            gameState.hand.splice(cardIndex, 1);
            
            updateDisplay();
            return true;
        }

        // Appliquer l'effet d'une carte
        function applyCardEffect(card) {
            switch(card.type) {
                case 'ally':
                    summonAlly(card);
                    break;
                case 'spell':
                    castSpell(card);
                    break;
                case 'item':
                    equipItem(card);
                    break;
                case 'condition':
                    activateCondition(card);
                    break;
                default:
                    showNotification(`‚ú® Effet de ${card.name} : ${card.effect}`, "info");
            }
        }

        function summonAlly(card) {
            gameState.allies.push({
                id: card.id,
                name: card.name,
                power: card.power || 1,
                locationId: gameState.currentLocation,
                element: null
            });
            showNotification(`‚öîÔ∏è ${card.name} rejoint votre cause !`, "success");
        }

        function castSpell(card) {
            // Effets sp√©ciaux selon la carte
            switch(card.id) {
                case 'maleficent_spell':
                    if (gameState.currentVillain.name === 'Maleficent') {
                        const location = findLocationById(gameState.currentLocation);
                        curse_spell(location);
                    }
                    break;
                case 'hypnotize':
                    if (gameState.currentVillain.name === 'Jafar') {
                        const location = findLocationById(gameState.currentLocation);
                        hypnotize_guards(location);
                    }
                    break;
                case 'green_fire':
                    gameState.power += 3;
                    showNotification("üî• Feu vert : +3 Pouvoir ce tour !", "success");
                    break;
                default:
                    showNotification(`ü™Ñ Sort lanc√© : ${card.effect}`, "info");
            }
        }

        function equipItem(card) {
            gameState.items.push(card);
            showNotification(`üõ°Ô∏è Objet √©quip√© : ${card.name}`, "success");
        }

        function activateCondition(card) {
            gameState.conditions.push(card);
            showNotification(`‚ö° Condition active : ${card.name}`, "info");
        }

        const VILLAINS = {
            jafar: {
                id: 'jafar',
                name: 'Jafar',
                icon: 'üßû‚Äç‚ôÇÔ∏è',
                description: 'Le vizir mal√©fique d\'Agrabah qui cherche √† devenir le g√©nie le plus puissant',
                startingPower: 4,
                victoryCondition: 'Avoir la Lampe Magique √† la Caverne aux Merveilles et localiser Jasmine',
                color: '#8B4513',
                board: [
                    {
                        id: 'palace_gates',
                        name: 'Portes du Palais',
                        actions: [
                            { type: 'gain_power', value: 2, icon: 'üí∞' },
                            { type: 'play_card', icon: 'üÉè', blockedByHeroes: true },
                            { type: 'vanquish', icon: '‚öîÔ∏è' },
                            { type: 'discard', icon: 'üóëÔ∏è' }
                        ]
                    },
                    {
                        id: 'throne_room',
                        name: 'Salle du Tr√¥ne',
                        actions: [
                            { type: 'gain_power', value: 1, icon: 'üí∞' },
                            { type: 'play_card', icon: 'üÉè' },
                            { type: 'activate', icon: 'üîß', blockedByHeroes: true },
                            { type: 'fate', icon: 'üîÆ' }
                        ]
                    },
                    {
                        id: 'cave_of_wonders',
                        name: 'Caverne aux Merveilles',
                        actions: [
                            { type: 'play_card', icon: 'üÉè', blockedByHeroes: true },
                            { type: 'activate', icon: 'üîß' },
                            { type: 'discard', icon: 'üóëÔ∏è' },
                            { type: 'gain_power', value: 3, icon: 'üí∞' }
                        ]
                    },
                    {
                        id: 'secret_chamber',
                        name: 'Chambre Secr√®te',
                        actions: [
                            { type: 'gain_power', value: 1, icon: 'üí∞' },
                            { type: 'play_card', icon: 'üÉè' },
                            { type: 'hypnotize_guards', icon: 'üëÅÔ∏è' }
                        ]
                    }
                ]
            },
            maleficent: {
                id: 'maleficent',
                name: 'Maleficent',
                icon: 'üßô‚Äç‚ôÄÔ∏è',
                description: 'La Ma√Ætresse du Mal qui veut placer une mal√©diction sur chaque lieu',
                startingPower: 3,
                victoryCondition: 'Placer une Mal√©diction sur chaque lieu de votre domaine',
                color: '#4A0E4E',
                specialMechanic: 'curse_placement',
                board: [
                    {
                        id: 'forbidden_mountains',
                        name: 'Montagnes Interdites',
                        actions: [
                            { type: 'gain_power', value: 2, icon: 'üí∞' },
                            { type: 'play_card', icon: 'üÉè' },
                            { type: 'vanquish', icon: '‚öîÔ∏è' },
                            { type: 'fate', icon: 'üîÆ' }
                        ],
                        cursed: false
                    },
                    {
                        id: 'briar_rose_cottage',
                        name: 'Chaumi√®re de Rose',
                        actions: [
                            { type: 'gain_power', value: 1, icon: 'üí∞' },
                            { type: 'play_card', icon: 'üÉè', blockedByHeroes: true },
                            { type: 'activate', icon: 'üîß' },
                            { type: 'discard', icon: 'üóëÔ∏è' }
                        ],
                        cursed: false
                    },
                    {
                        id: 'castle_gates',
                        name: 'Portes du Ch√¢teau',
                        actions: [
                            { type: 'play_card', icon: 'üÉè' },
                            { type: 'vanquish', icon: '‚öîÔ∏è', blockedByHeroes: true },
                            { type: 'activate', icon: 'üîß' },
                            { type: 'gain_power', value: 2, icon: 'üí∞' }
                        ],
                        cursed: false
                    },
                    {
                        id: 'throne_room_mal',
                        name: 'Salle du Tr√¥ne',
                        actions: [
                            { type: 'gain_power', value: 1, icon: 'üí∞' },
                            { type: 'play_card', icon: 'üÉè', blockedByHeroes: true },
                            { type: 'curse_spell', icon: 'ÔøΩ' },
                            { type: 'discard', icon: 'üóëÔ∏è' }
                        ],
                        cursed: false
                    }
                ],
                uniqueCards: [
                    { name: 'Mal√©diction', type: 'CONDITION', cost: 3, description: 'Place une Mal√©diction sur ce lieu. Requis pour la victoire.' },
                    { name: 'Dragon de Maleficent', type: 'ALLY', cost: 5, strength: 15, description: 'La forme draconique de Maleficent' },
                    { name: '√âpines Maudites', type: 'EFFECT', cost: 2, description: 'Tous les H√©ros perdent 3 Force ce tour' },
                    { name: 'B√¢ton Magique', type: 'ITEM', cost: 3, description: 'Les Mal√©dictions co√ªtent -1 Pouvoir' }
                ]
            },
            captain_hook: {
                id: 'captain_hook',
                name: 'Captain Hook',
                icon: 'üè¥‚Äç‚ò†Ô∏è',
                description: 'Le pirate impitoyable qui veut vaincre Peter Pan au Jolly Roger',
                startingPower: 5,
                victoryCondition: 'Vaincre Peter Pan lorsqu\'il est au Jolly Roger',
                color: '#2C5F41',
                specialMechanic: 'peter_pan_hunt',
                board: [
                    {
                        id: 'hooks_lair',
                        name: 'Repaire de Crochet',
                        actions: [
                            { type: 'gain_power', value: 2, icon: 'üí∞' },
                            { type: 'play_card', icon: 'üÉè' },
                            { type: 'vanquish', icon: '‚öîÔ∏è' },
                            { type: 'activate', icon: 'üîß' }
                        ]
                    },
                    {
                        id: 'skull_rock',
                        name: 'Rocher du Cr√¢ne',
                        actions: [
                            { type: 'gain_power', value: 1, icon: 'üí∞' },
                            { type: 'play_card', icon: 'üÉè', blockedByHeroes: true },
                            { type: 'activate', icon: 'üîß' },
                            { type: 'fate', icon: 'üîÆ' }
                        ]
                    },
                    {
                        id: 'jolly_roger',
                        name: 'Jolly Roger',
                        actions: [
                            { type: 'play_card', icon: 'üÉè' },
                            { type: 'vanquish', icon: '‚öîÔ∏è', blockedByHeroes: true },
                            { type: 'boarding_party', icon: 'üè¥‚Äç‚ò†Ô∏è' },
                            { type: 'gain_power', value: 3, icon: 'üí∞' }
                        ],
                        victoryLocation: true
                    },
                    {
                        id: 'mermaid_lagoon',
                        name: 'Lagon des Sir√®nes',
                        actions: [
                            { type: 'gain_power', value: 1, icon: 'üí∞' },
                            { type: 'play_card', icon: 'üÉè', blockedByHeroes: true },
                            { type: 'activate', icon: 'üîß' },
                            { type: 'discard', icon: 'üóëÔ∏è' }
                        ]
                    }
                ]
            },
            queen_hearts: {
                id: 'queen_hearts',
                name: 'Queen of Hearts',
                icon: 'üë∏',
                description: 'La reine tyrannique du Royaume des Cartes qui veut maintenir son pouvoir absolu',
                startingPower: 3,
                victoryCondition: 'Avoir 4 Gardes Cartes √† diff√©rents lieux et d√©capiter 3 h√©ros',
                color: '#DC143C',
                board: [
                    {
                        id: 'throne_room_queen',
                        name: 'Salle du Tr√¥ne',
                        actions: [
                            { type: 'gain_power', value: 2, icon: 'üí∞' },
                            { type: 'play_card', icon: 'üÉè' },
                            { type: 'royal_decree', icon: 'üëë', blockedByHeroes: true },
                            { type: 'vanquish', icon: '‚öîÔ∏è' }
                        ]
                    },
                    {
                        id: 'courtyard',
                        name: 'Cour Royale',
                        actions: [
                            { type: 'gain_power', value: 1, icon: 'üí∞' },
                            { type: 'play_card', icon: 'üÉè', blockedByHeroes: true },
                            { type: 'activate', icon: 'üîß' },
                            { type: 'fate', icon: 'üîÆ' }
                        ]
                    },
                    {
                        id: 'wicket_garden',
                        name: 'Jardin de Croquet',
                        actions: [
                            { type: 'play_card', icon: 'üÉè' },
                            { type: 'card_game_rules', icon: 'üéØ', blockedByHeroes: true },
                            { type: 'discard', icon: 'üóëÔ∏è' },
                            { type: 'gain_power', value: 1, icon: 'üí∞' }
                        ]
                    },
                    {
                        id: 'execution_grounds',
                        name: 'Terrain d\'Ex√©cution',
                        actions: [
                            { type: 'vanquish', icon: '‚öîÔ∏è' },
                            { type: 'play_card', icon: 'üÉè', blockedByHeroes: true },
                            { type: 'execute_decree', icon: '‚ö°' },
                            { type: 'discard', icon: 'üóëÔ∏è' }
                        ]
                    }
                ]
            },
            prince_john: {
                id: 'prince_john',
                name: 'Prince John',
                icon: 'ü§¥',
                description: 'Le prince avide qui taxe ses sujets pour remplir ses coffres royaux',
                startingPower: 5,
                victoryCondition: 'Accumuler 20 Pouvoir et avoir au moins 1 Tax dans chaque lieu',
                color: '#4B0082',
                board: [
                    {
                        id: 'nottingham',
                        name: 'Nottingham',
                        actions: [
                            { type: 'gain_power', value: 3, icon: 'üí∞' },
                            { type: 'play_card', icon: 'üÉè', blockedByHeroes: true },
                            { type: 'vanquish', icon: '‚öîÔ∏è' },
                            { type: 'discard', icon: 'üóëÔ∏è' }
                        ]
                    },
                    {
                        id: 'sherwood_forest',
                        name: 'For√™t de Sherwood',
                        actions: [
                            { type: 'gain_power', value: 1, icon: 'üí∞' },
                            { type: 'play_card', icon: 'üÉè' },
                            { type: 'activate', icon: 'üîß', blockedByHeroes: true },
                            { type: 'fate', icon: 'üîÆ' }
                        ]
                    },
                    {
                        id: 'royal_castle',
                        name: 'Ch√¢teau Royal',
                        actions: [
                            { type: 'play_card', icon: 'üÉè' },
                            { type: 'royal_treasury', icon: 'üíé', blockedByHeroes: true },
                            { type: 'gain_power', value: 2, icon: 'üí∞' },
                            { type: 'discard', icon: 'üóëÔ∏è' }
                        ]
                    },
                    {
                        id: 'village_square',
                        name: 'Place du Village',
                        actions: [
                            { type: 'taxation', icon: 'üèõÔ∏è' },
                            { type: 'play_card', icon: 'üÉè', blockedByHeroes: true },
                            { type: 'gain_power', value: 2, icon: 'üí∞' },
                            { type: 'activate', icon: 'üîß' }
                        ]
                    }
                ]
            }
        };

        // Gestion du loading screen am√©lior√©e
        let loadingProgress = 0;
        let loadingInterval;
        
        function startLoading() {
            loadingInterval = setInterval(() => {
                loadingProgress += Math.random() * 12 + 3; // Progression plus stable
                if (loadingProgress >= 100) {
                    loadingProgress = 100;
                    clearInterval(loadingInterval);
                    setTimeout(() => {
                        const loadingScreen = document.getElementById('loadingScreen');
                        if (loadingScreen) {
                            loadingScreen.style.opacity = '0';
                            loadingScreen.style.transition = 'opacity 0.5s ease-out';
                            setTimeout(() => {
                                loadingScreen.style.display = 'none';
                            }, 500);
                        }
                    }, 800);
                }
                const percentageElement = document.getElementById('loadingPercentage');
                if (percentageElement) {
                    percentageElement.textContent = Math.floor(loadingProgress) + '%';
                }
            }, 150);
        }

        // Timer du jeu am√©lior√©
        let gameTimer;
        
        function updateGameTimer() {
            try {
                const elapsed = Date.now() - gameState.gameStartTime;
                const minutes = Math.floor(elapsed / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);
                const timerElement = document.getElementById('gameTimer');
                if (timerElement) {
                    timerElement.textContent = 
                        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }
            } catch (error) {
                console.error('Erreur timer:', error);
            }
        }

        function startGameTimer() {
            if (gameTimer) clearInterval(gameTimer);
            gameTimer = setInterval(updateGameTimer, 1000);
        }

        // Fonctions du menu principal am√©lior√©es
        function startNewGame() {
            try {
                const mainMenu = document.getElementById('mainMenu');
                const gameInterface = document.getElementById('gameInterface');
                
                if (mainMenu && gameInterface) {
                    mainMenu.style.display = 'none';
                    gameInterface.classList.add('active');
                    gameState.gameStartTime = Date.now(); // Reset timer
                    startGameTimer();
                    showNotification('üéÆ Nouvelle partie commenc√©e !', 'success');
                } else {
                    console.error('√âl√©ments menu/interface non trouv√©s');
                }
            } catch (error) {
                console.error('Erreur d√©marrage:', error);
                showNotification('‚ùå Erreur lors du d√©marrage', 'error');
            }
        }

        // D√©marrer le Mode R√®gles Officielles avec s√©lection de m√©chant
        function startOfficialMode() {
            console.log('‚ö° Mode R√®gles Officielles activ√©');
            
            // Afficher d'abord le s√©lecteur de m√©chant
            showVillainSelector();
        }

        // Afficher le s√©lecteur de m√©chant
        function showVillainSelector() {
            let villainOptions = '';
            
            Object.keys(VILLAINS).forEach(villainId => {
                const villain = VILLAINS[villainId];
                villainOptions += `
                    <div class="villain-option" onclick="selectVillainAndStart('${villainId}')">
                        <div class="villain-icon">${villain.icon}</div>
                        <div class="villain-info">
                            <h3>${villain.name}</h3>
                            <p class="villain-desc">${villain.description}</p>
                            <p class="victory-condition">üéØ ${villain.victoryCondition}</p>
                            <div class="villain-stats">
                                ‚ö° Pouvoir de d√©part: ${villain.startingPower}
                                ${villain.specialMechanic ? ` | üîÆ M√©canique: ${villain.specialMechanic}` : ''}
                            </div>
                        </div>
                    </div>
                `;
            });

            const modal = createModal('üè∞ Choisissez votre M√©chant', `
                <div class="villain-selector">
                    <p style="text-align: center; margin-bottom: 1.5rem; color: #DAA520; font-weight: 600;">
                        Chaque m√©chant a ses propres r√®gles et objectifs uniques
                    </p>
                    <div class="villain-options">
                        ${villainOptions}
                    </div>
                </div>
            `);
            showModal(modal);
        }

        // S√©lectionner un m√©chant et d√©marrer la partie
        function selectVillainAndStart(villainId) {
            const villain = VILLAINS[villainId];
            if (!villain) return;

            // Mettre √† jour l'√©tat du jeu
            gameState.currentPlayer = villain.name;
            gameState.playerPower = villain.startingPower;
            gameState.selectedVillain = villainId;

            closeModal();

            // D√©marrer la partie normale
            startNewGame();

            // Configurer le plateau pour ce m√©chant
            setTimeout(() => {
                setupVillainBoard(villainId);
                initializeVillainDecks(villain.name); // Initialiser les cartes
                
                showNotification(`üé≠ Vous incarnez ${villain.name} !\n\nüéØ Objectif: ${villain.victoryCondition}\n‚ö° Pouvoir de d√©part: ${villain.startingPower}`, 'success');
                
                // D√©marrer le premier tour officiel
                setTimeout(() => {
                    startOfficialTurn();
                }, 3000);
            }, 1000);
        }

        // Configuration du plateau sp√©cifique au m√©chant
        function setupVillainBoard(villainId) {
            const villain = VILLAINS[villainId];
            if (!villain) return;

            // Mettre √† jour le titre et les informations
            const titleElement = document.querySelector('#villain-info h2');
            if (titleElement) {
                titleElement.textContent = villain.name;
                titleElement.style.color = villain.color;
            }

            // Configurer les lieux du plateau
            setupVillainLocations(villain);
            
            // Appliquer le th√®me visuel
            applyVillainTheme(villain);
            
            // Mettre √† jour l'√©tat du jeu
            gameState.currentVillain = villain;
            gameState.power = villain.startingPower;
            gameState.specialMechanics = {};
            
            updateDisplay();
        }

        function setupVillainLocations(villain) {
            const locationsContainer = document.querySelector('.locations-container');
            if (!locationsContainer) return;

            locationsContainer.innerHTML = '';
            
            villain.board.forEach(location => {
                const locationElement = createLocationElement(location);
                locationsContainer.appendChild(locationElement);
            });
        }

        function createLocationElement(location) {
            const locationDiv = document.createElement('div');
            locationDiv.className = 'location-card';
            locationDiv.dataset.locationId = location.id;
            locationDiv.style.position = 'relative';
            
            locationDiv.innerHTML = `
                <div class="location-name">${location.name}</div>
                <div class="location-actions">
                    ${location.actions.map(action => `
                        <div class="action-icon" title="${getActionDescription(action)}" onclick="performLocationAction('${action.type}', ${JSON.stringify(action).replace(/"/g, '&quot;')})">
                            ${action.icon}
                        </div>
                    `).join('')}
                </div>
            `;
            
            locationDiv.addEventListener('click', () => selectLocation(location.id));
            
            return locationDiv;
        }

        function getActionDescription(action) {
            const descriptions = {
                'gain_power': `Gagner ${action.value} Pouvoir`,
                'move_item': 'D√©placer un objet ou alli√©',
                'play_card': 'Jouer une carte',
                'activate_location': 'Activer le lieu',
                'curse_spell': 'Lancer une mal√©diction',
                'boarding_party': 'Organiser un abordage',
                'hypnotize_guards': 'Hypnotiser les gardes'
            };
            return descriptions[action.type] || action.type;
        }

        function performLocationAction(actionType, actionData) {
            if (gameState.phase !== 'actions' || gameState.actionsRemaining <= 0) {
                showNotification('‚ùå Aucune action disponible !', 'warning');
                return;
            }

            // Appeler la fonction performAction existante
            performAction(actionType, actionData);
        }

        function selectLocation(locationId) {
            gameState.currentLocation = locationId;
            
            // Mettre en surbrillance le lieu s√©lectionn√©
            document.querySelectorAll('.location-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            const selectedCard = document.querySelector(`[data-location-id="${locationId}"]`);
            if (selectedCard) {
                selectedCard.classList.add('selected');
            }
            
            showNotification(`üìç Lieu s√©lectionn√© : ${getLocationName(locationId)}`, 'info');
        }

        function getLocationName(locationId) {
            const villain = gameState.currentVillain;
            if (!villain) return locationId;
            
            const location = villain.board.find(loc => loc.id === locationId);
            return location ? location.name : locationId;
        }

        function applyVillainTheme(villain) {
            // Appliquer la couleur th√®me du m√©chant
            document.documentElement.style.setProperty('--villain-color', villain.color);
            
            // Modifier l'arri√®re-plan si n√©cessaire
            const body = document.body;
            body.style.background = `radial-gradient(circle at center, ${villain.color}22, #0a0a1f)`;
        }

        // D√©marrer un tour officiel
        function startOfficialTurn() {
            console.log(`üéØ === TOUR OFFICIEL ${gameState.turnNumber} - ${gameState.currentPlayer} ===`);
            
            // Phase 1: D√©placement obligatoire
            gameState.phase = 'move';
            gameState.actionsRemaining = 0;
            
            showNotification(`üö∂‚Äç‚ôÇÔ∏è PHASE 1: D√âPLACEMENT\n\nVous devez vous d√©placer vers un lieu adjacent.\nLes lieux disponibles sont surlign√©s en vert.`, 'info');
            
            // Surligner les lieux adjacents
            highlightAdjacentLocations();
            
            // Cr√©er/mettre √† jour l'affichage du tour
            updateOfficialTurnDisplay();
        }

        // Surligner les lieux adjacents pour le d√©placement
        function highlightAdjacentLocations() {
            const locations = document.querySelectorAll('.location-card');
            const currentLoc = gameState.currentLocation;
            
            locations.forEach(loc => {
                const locationId = loc.dataset.location;
                loc.classList.remove('available-movement', 'blocked-movement');
                loc.style.border = '';
                loc.title = '';
                
                if (locationId === currentLoc) {
                    loc.style.border = '3px solid #FF0000';
                    loc.title = 'üìç Lieu actuel - Vous devez vous d√©placer';
                } else if (isAdjacentLocation(currentLoc, locationId)) {
                    loc.classList.add('available-movement');
                    loc.style.border = '3px solid #00FF00';
                    loc.title = '‚úÖ Cliquez pour vous d√©placer ici';
                    loc.style.cursor = 'pointer';
                } else {
                    loc.style.border = '3px solid #666';
                    loc.title = '‚ùå Trop √©loign√© - Seuls les lieux adjacents sont accessibles';
                    loc.style.cursor = 'not-allowed';
                }
            });
        }

        // Mettre √† jour l'affichage du tour officiel
        function updateOfficialTurnDisplay() {
            // Chercher ou cr√©er le panneau de tour
            let turnPanel = document.getElementById('officialTurnPanel');
            if (!turnPanel) {
                turnPanel = document.createElement('div');
                turnPanel.id = 'officialTurnPanel';
                turnPanel.style.cssText = `
                    position: fixed;
                    top: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: linear-gradient(135deg, #1a1a2e, #16213e);
                    border: 3px solid #DAA520;
                    border-radius: 15px;
                    padding: 1rem;
                    color: #F5F5F5;
                    font-family: 'Cinzel', serif;
                    z-index: 1000;
                    box-shadow: 0 8px 25px rgba(218, 165, 32, 0.3);
                    text-align: center;
                    min-width: 350px;
                `;
                document.body.appendChild(turnPanel);
            }

            const phaseInfo = TURN_PHASES[gameState.phase.toUpperCase()];
            const phaseIcon = phaseInfo ? phaseInfo.icon : '‚ùì';
            const phaseName = phaseInfo ? phaseInfo.name : gameState.phase;
            const phaseDesc = phaseInfo ? phaseInfo.description : '';

            turnPanel.innerHTML = `
                <div style="font-size: 1.4rem; font-weight: 700; color: #DAA520; margin-bottom: 0.5rem;">
                    ‚ö° TOUR OFFICIEL ${gameState.turnNumber}
                </div>
                <div style="font-size: 1.2rem; margin-bottom: 0.5rem;">
                    üëë ${gameState.currentPlayer}
                </div>
                <div style="background: rgba(218, 165, 32, 0.2); padding: 0.8rem; border-radius: 10px; margin: 0.5rem 0;">
                    <div style="font-size: 1.1rem; font-weight: 600; color: #DAA520;">
                        ${phaseIcon} Phase: ${phaseName}
                    </div>
                    <div style="font-size: 0.9rem; color: rgba(245, 245, 245, 0.8); margin-top: 0.3rem;">
                        ${phaseDesc}
                    </div>
                    ${gameState.actionsRemaining > 0 ? `<div style="background: #DAA520; color: #1a1a2e; padding: 0.3rem 0.8rem; border-radius: 15px; margin-top: 0.5rem; font-weight: 600;">‚ö° Actions restantes: ${gameState.actionsRemaining}</div>` : ''}
                </div>
                <div style="font-size: 0.8rem; color: rgba(245, 245, 245, 0.6);">
                    üí∞ Pouvoir: ${gameState.playerPower} | üÉè Cartes: ${getCurrentHandSize()}
                </div>
            `;
        }

        function loadSavedGame() {
            showNotification('üìÅ Chargement des parties sauvegard√©es...', 'info');
        }

        function showTutorial() {
            showNotification('üéì Lancement du tutoriel interactif...', 'info');
        }

        function showCredits() {
            showNotification('üèÜ D√©velopp√© par Villain Studios\n¬© 2025 Disney Villainous‚Ñ¢', 'info');
        }

        function exitGame() {
            if (confirm('Voulez-vous vraiment quitter le jeu ?')) {
                window.close();
            }
        }

        // Fonctions de jeu
        function selectLocation(location) {
            try {
                // D√©s√©lectionner toutes les locations
                document.querySelectorAll('.location-card').forEach(card => {
                    card.classList.remove('active');
                });
                
                // S√©lectionner la nouvelle location
                const targetLocation = document.querySelector(`[data-location="${location}"]`);
                if (targetLocation) {
                    targetLocation.classList.add('active');
                    gameState.currentLocation = location;
                    
                    // Mettre √† jour l'affichage
                    updateLocationDisplay(location);
                    showNotification(`üìç D√©plac√© vers ${getLocationName(location)}`, 'success');
                } else {
                    console.error(`Location ${location} non trouv√©e`);
                }
            } catch (error) {
                console.error('Erreur s√©lection location:', error);
                showNotification('‚ùå Erreur de d√©placement', 'error');
            }
        }

        function getLocationName(location) {
            const names = {
                'palace': 'Palais du Sultan',
                'streets': 'Rues d\'Agrabah',
                'oasis': 'Oasis',
                'cave': 'Caverne aux Merveilles'
            };
            return names[location] || location;
        }

        function updateLocationDisplay(location) {
            try {
                const locationElement = document.getElementById('currentLocation');
                if (locationElement) {
                    locationElement.textContent = getLocationName(location);
                }
            } catch (error) {
                console.error('Erreur mise √† jour location:', error);
            }
        }

        function selectCard(cardElement) {
            try {
                if (!cardElement) return;
                
                // D√©s√©lectionner toutes les cartes
                document.querySelectorAll('.game-card').forEach(card => {
                    card.style.border = '2px solid var(--primary-gold)';
                    card.style.transform = '';
                });
                
                // S√©lectionner la carte cliqu√©e
                cardElement.style.border = '3px solid #FFD700';
                cardElement.style.transform = 'scale(1.02)';
                gameState.selectedCard = cardElement;
                
                // Feedback visuel
                showNotification(`üÉè Carte s√©lectionn√©e: ${cardElement.querySelector('.card-name')?.textContent || 'Inconnue'}`, 'info');
            } catch (error) {
                console.error('Erreur s√©lection carte:', error);
            }
        }

        function showCardMenu(event, cardElement) {
            try {
                event.preventDefault();
                event.stopPropagation();
                
                if (!cardElement) return;
                
                gameState.selectedCard = cardElement;
                selectCard(cardElement); // Visuellement s√©lectionner la carte
                
                const menu = document.getElementById('contextMenu');
                if (menu) {
                    menu.style.display = 'block';
                    menu.style.left = Math.min(event.pageX, window.innerWidth - 200) + 'px';
                    menu.style.top = Math.min(event.pageY, window.innerHeight - 150) + 'px';
                }
            } catch (error) {
                console.error('Erreur menu carte:', error);
            }
        }

        // Fermer le menu contextuel am√©lior√©
        document.addEventListener('click', (event) => {
            try {
                const contextMenu = document.getElementById('contextMenu');
                if (contextMenu && !contextMenu.contains(event.target)) {
                    contextMenu.style.display = 'none';
                }
            } catch (error) {
                console.error('Erreur fermeture menu:', error);
            }
        });

        // Emp√™cher le menu contextuel par d√©faut
        document.addEventListener('contextmenu', (event) => {
            if (event.target.closest('.game-card')) {
                event.preventDefault();
            }
        });

        // Actions de jeu am√©lior√©es
        function gainPower() {
            try {
                gameState.playerPower += 2;
                const powerElement = document.getElementById('playerPower');
                if (powerElement) {
                    powerElement.textContent = gameState.playerPower;
                    // Animation du gain de pouvoir
                    powerElement.style.transform = 'scale(1.2)';
                    powerElement.style.color = '#4CAF50';
                    setTimeout(() => {
                        powerElement.style.transform = 'scale(1)';
                        powerElement.style.color = 'var(--primary-gold)';
                    }, 300);
                }
                showNotification('üí∞ +2 Pouvoir gagn√© !', 'success');
            } catch (error) {
                console.error('Erreur gain pouvoir:', error);
                showNotification('‚ùå Erreur lors du gain de pouvoir', 'error');
            }
        }

        function playCard() {
            try {
                if (!gameState.selectedCard) {
                    showNotification('‚ùå S√©lectionnez d\'abord une carte !', 'error');
                    return;
                }
                
                const cardNameElement = gameState.selectedCard.querySelector('.card-name');
                const cardCostElement = gameState.selectedCard.querySelector('.card-cost');
                
                if (!cardNameElement || !cardCostElement) {
                    showNotification('‚ùå Carte invalide !', 'error');
                    return;
                }
                
                const cardName = cardNameElement.textContent;
                const cost = parseInt(cardCostElement.textContent);
                
                if (isNaN(cost)) {
                    showNotification('‚ùå Co√ªt de carte invalide !', 'error');
                    return;
                }
                
                if (gameState.playerPower >= cost) {
                    gameState.playerPower -= cost;
                    const powerElement = document.getElementById('playerPower');
                    if (powerElement) {
                        powerElement.textContent = gameState.playerPower;
                    }
                    
                    // Animation de suppression de carte
                    gameState.selectedCard.style.transform = 'scale(0) rotate(180deg)';
                    gameState.selectedCard.style.opacity = '0';
                    
                    setTimeout(() => {
                        if (gameState.selectedCard && gameState.selectedCard.parentNode) {
                            gameState.selectedCard.remove();
                        }
                        gameState.selectedCard = null;
                        updateHandSize();
                    }, 300);
                    
                    showNotification(`üÉè ${cardName} jou√© ! (-${cost} Pouvoir)`, 'success');
                } else {
                    showNotification(`‚ùå Pas assez de Pouvoir ! (${cost} requis, ${gameState.playerPower} disponible)`, 'error');
                }
            } catch (error) {
                console.error('Erreur jeu carte:', error);
                showNotification('‚ùå Erreur lors du jeu de la carte', 'error');
            }
        }

        function playSelectedCard() {
            playCard();
            document.getElementById('contextMenu').style.display = 'none';
        }

        function discardSelectedCard() {
            if (gameState.selectedCard) {
                const cardName = gameState.selectedCard.querySelector('.card-name').textContent;
                gameState.selectedCard.remove();
                updateHandSize();
                showNotification(`üóëÔ∏è ${cardName} d√©fauss√©`, 'info');
            }
            document.getElementById('contextMenu').style.display = 'none';
        }

        function discardCards() {
            if (gameState.selectedCard) {
                discardSelectedCard();
            } else {
                showNotification('‚ùå S√©lectionnez d\'abord une carte √† d√©fausser !', 'error');
            }
        }

        function examineCard() {
            if (gameState.selectedCard) {
                const cardName = gameState.selectedCard.querySelector('.card-name').textContent;
                const description = gameState.selectedCard.querySelector('.card-description').textContent;
                showNotification(`üîç ${cardName}\n\n${description}`, 'info');
            }
            document.getElementById('contextMenu').style.display = 'none';
        }

        function updateHandSize() {
            try {
                const handSize = document.querySelectorAll('.game-card').length;
                const handSizeElement = document.getElementById('handSize');
                if (handSizeElement) {
                    handSizeElement.textContent = handSize;
                }
            } catch (error) {
                console.error('Erreur mise √† jour main:', error);
            }
        }

        function endTurn() {
            try {
                gameState.turnNumber++;
                const turnElement = document.getElementById('turnNumber');
                if (turnElement) {
                    turnElement.textContent = gameState.turnNumber;
                }
                
                // R√©initialiser la s√©lection
                gameState.selectedCard = null;
                document.querySelectorAll('.game-card').forEach(card => {
                    card.style.border = '2px solid var(--primary-gold)';
                    card.style.transform = '';
                });
                
                showNotification(`‚è≠Ô∏è Tour ${gameState.turnNumber} commenc√© !`, 'info');
            } catch (error) {
                console.error('Erreur fin de tour:', error);
                showNotification('‚ùå Erreur lors de la fin du tour', 'error');
            }
        }

        // Fonctions d'interface
        function showHelp() {
            showNotification('‚ùì Aide\n\nüéØ Objectif: Accomplissez la condition de victoire de votre m√©chant\nüÉè Cartes: Cliquez pour s√©lectionner, clic droit pour le menu\nüìç Lieux: Cliquez pour vous d√©placer', 'info');
        }

        function showSettings() {
            showNotification('‚öôÔ∏è Param√®tres\n\nOptions disponibles:\n‚Ä¢ Volume: 50%\n‚Ä¢ Effets visuels: Activ√©s\n‚Ä¢ Sauvegarde auto: Activ√©e', 'info');
        }

        function saveGame() {
            showNotification('üíæ Partie sauvegard√©e !', 'success');
        }

        // Syst√®me de notifications am√©lior√©
        let notificationCount = 0;
        
        function showNotification(message, type = 'info') {
            try {
                notificationCount++;
                const notification = document.createElement('div');
                const notificationId = `notification-${notificationCount}`;
                notification.id = notificationId;
                
                notification.style.cssText = `
                    position: fixed;
                    top: ${100 + (notificationCount - 1) * 80}px;
                    right: 20px;
                    background: var(--surface-dark);
                    color: var(--text-light);
                    padding: 1rem 1.5rem;
                    border-radius: 10px;
                    border: 2px solid var(--primary-gold);
                    z-index: 2500;
                    max-width: 300px;
                    box-shadow: var(--shadow-main);
                    animation: slideIn 0.3s ease-out;
                    white-space: pre-line;
                    word-wrap: break-word;
                    font-size: 0.9rem;
                    line-height: 1.4;
                `;
                
                if (type === 'error') {
                    notification.style.borderColor = 'var(--accent-red)';
                    notification.style.background = 'linear-gradient(135deg, #B71C1C, var(--surface-dark))';
                } else if (type === 'success') {
                    notification.style.borderColor = '#4CAF50';
                    notification.style.background = 'linear-gradient(135deg, #4CAF50, var(--surface-dark))';
                }
                
                notification.textContent = message;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    try {
                        const notif = document.getElementById(notificationId);
                        if (notif) {
                            notif.style.animation = 'slideOut 0.3s ease-in';
                            setTimeout(() => {
                                if (notif.parentNode) {
                                    notif.remove();
                                }
                                notificationCount = Math.max(0, notificationCount - 1);
                            }, 300);
                        }
                    } catch (cleanupError) {
                        console.error('Erreur nettoyage notification:', cleanupError);
                    }
                }, 4000);
            } catch (error) {
                console.error('Erreur notification:', error);
            }
        }

        // Styles pour les animations de notifications
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Initialisation am√©lior√©e
        document.addEventListener('DOMContentLoaded', () => {
            try {
                console.log('üéÆ Initialisation Disney Villainous‚Ñ¢ Ultimate');
                
                // D√©marrer le loading
                startLoading();
                
                // Initialiser le timer
                startGameTimer();
                
                // Mettre √† jour la taille de main
                updateHandSize();
                
                // V√©rifier les √©l√©ments critiques
                const criticalElements = ['loadingScreen', 'mainMenu', 'gameInterface', 'contextMenu'];
                const missingElements = criticalElements.filter(id => !document.getElementById(id));
                
                if (missingElements.length > 0) {
                    console.error('√âl√©ments manquants:', missingElements);
                    showNotification('‚ö†Ô∏è Certains √©l√©ments de l\'interface sont manquants', 'error');
                } else {
                    console.log('‚úÖ Tous les √©l√©ments critiques sont pr√©sents');
                }
                
                // Message de bienvenue apr√®s le loading
                setTimeout(() => {
                    showNotification('üéÆ Disney Villainous‚Ñ¢ Professional Edition\nBienvenue dans l\'exp√©rience ultime !', 'success');
                }, 6000);
                
            } catch (error) {
                console.error('Erreur initialisation:', error);
                showNotification('‚ùå Erreur lors de l\'initialisation', 'error');
            }
        });

        // Gestion des erreurs globales
        window.addEventListener('error', (event) => {
            console.error('Erreur JavaScript:', event.error);
            showNotification('‚ö†Ô∏è Une erreur inattendue s\'est produite', 'error');
        });

        // Debugging tools (√† retirer en production)
        window.gameDebug = {
            state: () => gameState,
            resetPower: () => { gameState.playerPower = 10; document.getElementById('playerPower').textContent = 10; },
            showElements: () => console.log({
                loadingScreen: !!document.getElementById('loadingScreen'),
                mainMenu: !!document.getElementById('mainMenu'),
                gameInterface: !!document.getElementById('gameInterface'),
                contextMenu: !!document.getElementById('contextMenu')
            })
        };

        // ===== SYST√àME D'ANIMATIONS DE PLATEAUX TH√âMATIQUES =====
        
        class VillainBoardAnimations {
            constructor() {
                this.currentBoard = null;
                this.transitionDuration = 800;
                this.setupVillainEffects();
            }
            
            setupVillainEffects() {
                this.villainEffects = {
                    'captain_hook': {
                        theme: 'pirate',
                        particles: 'üåä‚öìüè¥‚Äç‚ò†Ô∏è',
                        ambientColor: '#2C5F41'
                    },
                    'maleficent': {
                        theme: 'dark_magic',
                        particles: '‚ú®üîÆüíú',
                        ambientColor: '#4A0E4E'
                    },
                    'jafar': {
                        theme: 'oriental',
                        particles: 'üåüüïåüíé',
                        ambientColor: '#8B4513'
                    },
                    'queen_hearts': {
                        theme: 'cards',
                        particles: '‚ô†Ô∏è‚ô•Ô∏è‚ô¶Ô∏è‚ô£Ô∏è',
                        ambientColor: '#DC143C'
                    },
                    'prince_john': {
                        theme: 'royal',
                        particles: 'üëëüí∞üè∞',
                        ambientColor: '#4B0082'
                    }
                };
            }
            
            switchToVillainBoard(villainId) {
                return new Promise((resolve) => {
                    const boardElement = document.querySelector('.board-container');
                    if (boardElement) {
                        this.applyVillainTheme(villainId, boardElement);
                        this.animateBoardEntrance(villainId, boardElement).then(resolve);
                    }
                });
            }
            
            applyVillainTheme(villainId, boardElement) {
                // Nettoyer les classes pr√©c√©dentes
                boardElement.className = 'board-container villain-board';
                
                // Appliquer la nouvelle classe th√©matique
                const themeClass = villainId.replace('_', '-');
                boardElement.classList.add(themeClass);
            }
            
            animateBoardEntrance(villainId, boardElement) {
                return new Promise((resolve) => {
                    boardElement.classList.add('board-transition-enter');
                    
                    // Animer chaque lieu avec un d√©lai
                    const locations = boardElement.querySelectorAll('.location-card');
                    locations.forEach((location, index) => {
                        setTimeout(() => {
                            this.animateLocationEntrance(location, villainId);
                        }, index * 150);
                    });
                    
                    setTimeout(() => {
                        boardElement.classList.remove('board-transition-enter');
                        this.startAmbientEffects(villainId, boardElement);
                        resolve();
                    }, this.transitionDuration);
                });
            }
            
            animateLocationEntrance(locationElement, villainId) {
                locationElement.style.opacity = '0';
                locationElement.style.transform = 'translateY(30px) scale(0.8)';
                
                setTimeout(() => {
                    locationElement.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
                    locationElement.style.opacity = '1';
                    locationElement.style.transform = 'translateY(0) scale(1)';
                    
                    // Effet de particules √† l'arriv√©e
                    this.createLocationParticles(locationElement, villainId);
                }, 50);
            }
            
            highlightCurrentLocation(locationElement, villainId) {
                // Retirer la surbrillance des autres lieux
                document.querySelectorAll('.location-card.active')
                    .forEach(loc => loc.classList.remove('active'));
                
                // Ajouter la surbrillance au lieu actuel
                locationElement.classList.add('active');
                
                // Animation sp√©ciale d'arriv√©e
                this.playLocationArrivalAnimation(locationElement, villainId);
            }
            
            playLocationArrivalAnimation(locationElement, villainId) {
                const effects = this.villainEffects[villainId];
                
                // Cr√©er une onde d'√©nergie
                const ripple = document.createElement('div');
                ripple.className = 'location-ripple';
                ripple.style.cssText = `
                    position: absolute;
                    top: 50%;
                    left: 50%;
                    width: 0;
                    height: 0;
                    border-radius: 50%;
                    background: radial-gradient(circle, ${effects.ambientColor}40 0%, transparent 70%);
                    transform: translate(-50%, -50%);
                    pointer-events: none;
                    z-index: 1000;
                `;
                
                locationElement.appendChild(ripple);
                
                // Animation de l'onde
                ripple.animate([
                    { width: '0px', height: '0px', opacity: 1 },
                    { width: '200px', height: '200px', opacity: 0 }
                ], {
                    duration: 800,
                    easing: 'ease-out'
                }).onfinish = () => ripple.remove();
                
                // Particules th√©matiques
                this.createThematicParticles(locationElement, villainId);
            }
            
            createLocationParticles(locationElement, villainId) {
                const effects = this.villainEffects[villainId];
                const particles = effects.particles.split('');
                
                for (let i = 0; i < 3; i++) {
                    setTimeout(() => {
                        this.createSingleParticle(
                            locationElement, 
                            particles[Math.floor(Math.random() * particles.length)]
                        );
                    }, i * 200);
                }
            }
            
            createThematicParticles(locationElement, villainId) {
                const effects = this.villainEffects[villainId];
                const particles = effects.particles.split('');
                const rect = locationElement.getBoundingClientRect();
                
                for (let i = 0; i < 5; i++) {
                    setTimeout(() => {
                        this.createFloatingParticle(
                            rect.left + rect.width / 2,
                            rect.top + rect.height / 2,
                            particles[Math.floor(Math.random() * particles.length)],
                            effects.ambientColor
                        );
                    }, i * 100);
                }
            }
            
            createSingleParticle(container, emoji) {
                const particle = document.createElement('div');
                particle.textContent = emoji;
                particle.style.cssText = `
                    position: absolute;
                    top: ${Math.random() * 100}%;
                    left: ${Math.random() * 100}%;
                    font-size: ${12 + Math.random() * 8}px;
                    pointer-events: none;
                    z-index: 1000;
                    opacity: 0;
                `;
                
                container.appendChild(particle);
                
                // Animation de particule
                particle.animate([
                    { opacity: 0, transform: 'translateY(0px) scale(0.5)' },
                    { opacity: 1, transform: 'translateY(-20px) scale(1)' },
                    { opacity: 0, transform: 'translateY(-40px) scale(0.5)' }
                ], {
                    duration: 2000,
                    easing: 'ease-out'
                }).onfinish = () => particle.remove();
            }
            
            createFloatingParticle(x, y, emoji, color) {
                const particle = document.createElement('div');
                particle.textContent = emoji;
                particle.style.cssText = `
                    position: fixed;
                    left: ${x}px;
                    top: ${y}px;
                    font-size: 20px;
                    pointer-events: none;
                    z-index: 10000;
                    filter: drop-shadow(0 0 10px ${color});
                `;
                
                document.body.appendChild(particle);
                
                // Trajectoire al√©atoire
                const angle = Math.random() * Math.PI * 2;
                const distance = 100 + Math.random() * 100;
                const endX = x + Math.cos(angle) * distance;
                const endY = y + Math.sin(angle) * distance;
                
                particle.animate([
                    { opacity: 1, transform: 'translate(-50%, -50%) scale(0.5) rotate(0deg)' },
                    { opacity: 1, transform: `translate(${endX - x - 10}px, ${endY - y - 10}px) scale(1) rotate(360deg)` },
                    { opacity: 0, transform: `translate(${endX - x - 10}px, ${endY - y - 30}px) scale(0.3) rotate(720deg)` }
                ], {
                    duration: 3000,
                    easing: 'cubic-bezier(0.4, 0, 0.2, 1)'
                }).onfinish = () => particle.remove();
            }
            
            startAmbientEffects(villainId, boardElement) {
                // Arr√™ter les effets pr√©c√©dents
                this.stopAmbientEffects();
                
                // Commencer les nouveaux effets
                this.ambientInterval = setInterval(() => {
                    this.createAmbientEffect(villainId, boardElement);
                }, 5000 + Math.random() * 5000);
            }
            
            stopAmbientEffects() {
                if (this.ambientInterval) {
                    clearInterval(this.ambientInterval);
                    this.ambientInterval = null;
                }
            }
            
            createAmbientEffect(villainId, boardElement) {
                const effects = this.villainEffects[villainId];
                const locations = boardElement.querySelectorAll('.location-card');
                
                if (locations.length > 0) {
                    const randomLocation = locations[Math.floor(Math.random() * locations.length)];
                    
                    // Effet visuel subtil
                    this.addTemporaryEffect(randomLocation, effects.theme);
                    
                    // Particule occasionnelle
                    if (Math.random() < 0.3) {
                        this.createLocationParticles(randomLocation, villainId);
                    }
                }
            }
            
            addTemporaryEffect(element, theme) {
                const effectClass = `${theme}-effect`;
                element.classList.add(effectClass);
                
                setTimeout(() => {
                    element.classList.remove(effectClass);
                }, 2000);
            }
            
            cleanup() {
                this.stopAmbientEffects();
            }
        }

        // Instance globale des animations
        let villainBoardAnimations;

        // Initialiser les animations apr√®s le chargement
        document.addEventListener('DOMContentLoaded', () => {
            villainBoardAnimations = new VillainBoardAnimations();
            
            // Appliquer le th√®me initial si un m√©chant est s√©lectionn√©
            if (gameState.currentPlayer && VILLAINS[gameState.currentPlayer.toLowerCase()]) {
                villainBoardAnimations.switchToVillainBoard(gameState.currentPlayer.toLowerCase());
            }
        });

        // Fonction pour changer de m√©chant avec animations
        function switchVillain(villainId) {
            if (villainBoardAnimations && VILLAINS[villainId]) {
                villainBoardAnimations.switchToVillainBoard(villainId);
                gameState.currentPlayer = VILLAINS[villainId].name;
                showNotification(`üé≠ Vous incarnez maintenant ${VILLAINS[villainId].name}`, 'success');
            }
        }

        // S√©lection d'un m√©chant depuis le menu
        function selectVillainForGame(villainId) {
            // D√©s√©lectionner tous les m√©chants
            document.querySelectorAll('.villain-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // S√©lectionner le nouveau m√©chant
            const villainCard = document.querySelector(`[data-villain="${villainId}"]`);
            if (villainCard && !villainCard.classList.contains('coming-soon')) {
                villainCard.classList.add('selected');
                
                // Mettre √† jour l'√©tat du jeu
                const villain = VILLAINS[villainId];
                if (villain) {
                    gameState.currentPlayer = villain.name;
                    gameState.playerPower = villain.startingPower;
                    
                    // Notification avec informations du m√©chant
                    showNotification(`üé≠ ${villain.name} s√©lectionn√© !\n${villain.description}\n\nüéØ Objectif: ${villain.victoryCondition}`, 'success');
                }
            } else if (villainCard && villainCard.classList.contains('coming-soon')) {
                showNotification('üöß Ce m√©chant sera disponible dans une prochaine mise √† jour !', 'info');
            }
        }

        // ===== SYST√àME DE JEU OFFICIEL DISNEY VILLAINOUS =====
        
        // Variables d'√©tat du jeu selon les r√®gles officielles
        const OFFICIAL_GAME_STATE = {
            phase: 'move', // 'move', 'actions', 'draw', 'discard'
            actionsRemaining: 0,
            handLimit: 4,
            maxHandSize: 7,
            villainDeckSize: 30,
            fateDeckSize: 15
        };

        // Fonction pour cr√©er et afficher des modales
        function createGameModal(title, content) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center;
                z-index: 10000;
            `;
            modal.innerHTML = `
                <div style="background: var(--surface-dark); border-radius: 15px; border: 3px solid var(--primary-gold);
                           max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto;">
                    <div style="background: var(--gradient-gold); color: var(--primary-dark); padding: 1rem;
                               border-radius: 12px 12px 0 0; display: flex; justify-content: space-between; align-items: center;">
                        <h3 style="margin: 0; font-family: 'Cinzel', serif;">${title}</h3>
                        <button onclick="this.closest('div').parentElement.parentElement.remove()" 
                                style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--primary-dark);">√ó</button>
                    </div>
                    <div style="padding: 1.5rem; color: var(--text-light);">
                        ${content}
                    </div>
                </div>
            `;
            modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
            document.body.appendChild(modal);
            return modal;
        }

        // Syst√®me de messages am√©lior√©
        function showGameMessage(message, type = 'info') {
            const colors = { info: '#2196F3', success: '#4CAF50', warning: '#FF9800', error: '#F44336' };
            const msg = document.createElement('div');
            msg.textContent = message;
            msg.style.cssText = `
                position: fixed; top: 100px; right: 20px; padding: 1rem 1.5rem; border-radius: 10px;
                color: white; font-weight: 600; z-index: 9999; background: ${colors[type] || colors.info};
                transform: translateX(100%); transition: transform 0.3s ease; max-width: 300px;
            `;
            document.body.appendChild(msg);
            setTimeout(() => msg.style.transform = 'translateX(0)', 100);
            setTimeout(() => {
                msg.style.transform = 'translateX(100%)';
                setTimeout(() => msg.remove(), 300);
            }, 3000);
        }

        // D√©marrer le syst√®me officiel
        function activateOfficialRules() {
            // Copier l'√©tat actuel vers le syst√®me officiel
            Object.assign(OFFICIAL_GAME_STATE, {
                currentPlayer: gameState.currentPlayer,
                turnNumber: gameState.turnNumber,
                playerPower: gameState.playerPower,
                currentLocation: gameState.currentLocation
            });

            console.log('üéØ Syst√®me de r√®gles officielles Disney Villainous activ√© !');
            showGameMessage('R√®gles officielles activ√©es ! Cliquez sur "Nouveau Tour" pour commencer.', 'success');

            // Ajouter un bouton pour d√©marrer un tour officiel
            const gameBoard = document.querySelector('.game-board');
            if (gameBoard && !document.getElementById('officialTurnBtn')) {
                const button = document.createElement('button');
                button.id = 'officialTurnBtn';
                button.textContent = 'üéØ D√©marrer Tour Officiel';
                button.style.cssText = `
                    background: var(--gradient-gold); color: var(--primary-dark); border: none;
                    padding: 0.8rem 1.5rem; border-radius: 10px; font-weight: 600; cursor: pointer;
                    position: absolute; top: 10px; right: 10px; z-index: 100;
                `;
                button.onclick = startOfficialTurn;
                gameBoard.appendChild(button);
            }
        }

        // D√©marrer un tour selon les r√®gles officielles
        function startOfficialTurn() {
            OFFICIAL_GAME_STATE.phase = 'move';
            OFFICIAL_GAME_STATE.actionsRemaining = 0;
            
            const modal = createGameModal(
                `üéØ Tour ${gameState.turnNumber} - Phase: ${TURN_PHASES.MOVE.name}`,
                `
                <div style="text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 1rem;">${TURN_PHASES.MOVE.icon}</div>
                    <h4>${TURN_PHASES.MOVE.description}</h4>
                    <p>Vous √™tes actuellement √† : <strong>${gameState.currentLocation}</strong></p>
                    <p>Cliquez sur un lieu adjacent pour vous y d√©placer.</p>
                    <div style="margin-top: 1rem;">
                        <button onclick="this.closest('div').parentElement.parentElement.parentElement.remove(); highlightAdjacentLocations();"
                                style="background: var(--primary-gold); color: var(--primary-dark); border: none; 
                                       padding: 0.8rem 1.5rem; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            Voir les lieux disponibles
                        </button>
                    </div>
                </div>
                `
            );

            // Surligner les lieux adjacents
            setTimeout(() => highlightAdjacentLocations(), 500);
        }

        // Surligner les lieux adjacents
        function highlightAdjacentLocations() {
            const locations = document.querySelectorAll('.location-card');
            const currentLoc = gameState.currentLocation;
            const locationOrder = ['palace', 'throne', 'cave', 'chamber'];
            const currentIndex = locationOrder.indexOf(currentLoc);

            locations.forEach((loc, index) => {
                const locId = loc.dataset.location;
                const locIndex = locationOrder.indexOf(locId);
                const isAdjacent = Math.abs(currentIndex - locIndex) === 1 || 
                                   Math.abs(currentIndex - locIndex) === 3; // wrap-around

                if (isAdjacent && locId !== currentLoc) {
                    loc.style.border = '3px solid #00FF00';
                    loc.style.animation = 'pulse-green 1.5s infinite';
                    loc.style.cursor = 'pointer';
                    
                    // Ajouter un gestionnaire temporaire
                    const tempHandler = function() {
                        moveToLocationOfficial(locId);
                        loc.removeEventListener('click', tempHandler);
                    };
                    loc.addEventListener('click', tempHandler);
                } else {
                    loc.style.border = '';
                    loc.style.animation = '';
                }
            });

            showGameMessage('Cliquez sur un lieu adjacent (surlign√© en vert)', 'info');
        }

        // D√©placement officiel
        function moveToLocationOfficial(newLocationId) {
            // Nettoyer les surlignages
            document.querySelectorAll('.location-card').forEach(loc => {
                loc.style.border = '';
                loc.style.animation = '';
            });

            // Effectuer le d√©placement
            selectLocation(newLocationId);
            gameState.currentLocation = newLocationId;

            // Passer √† la phase d'actions
            OFFICIAL_GAME_STATE.phase = 'actions';
            startActionsPhase();
        }

        // Phase d'actions
        function startActionsPhase() {
            const currentLocation = document.querySelector(`[data-location="${gameState.currentLocation}"]`);
            const locationName = currentLocation.querySelector('.location-name').textContent;
            const actions = currentLocation.querySelectorAll('.action-icon');
            
            OFFICIAL_GAME_STATE.actionsRemaining = actions.length;

            const modal = createGameModal(
                `‚ö° Phase Actions - ${locationName}`,
                `
                <div style="text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 1rem;">‚ö°</div>
                    <h4>Effectuez toutes les actions disponibles</h4>
                    <p>Actions restantes : <span id="actionsCount">${OFFICIAL_GAME_STATE.actionsRemaining}</span></p>
                    <div style="margin-top: 1rem;">
                        <p>Cliquez sur les ic√¥nes d'action dans le lieu pour les effectuer.</p>
                        <button onclick="this.closest('div').parentElement.parentElement.parentElement.remove(); highlightActions();"
                                style="background: var(--primary-gold); color: var(--primary-dark); border: none; 
                                       padding: 0.8rem 1.5rem; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            Commencer les actions
                        </button>
                    </div>
                </div>
                `
            );

            setTimeout(() => highlightActions(), 500);
        }

        // Surligner les actions disponibles
        function highlightActions() {
            const currentLocation = document.querySelector(`[data-location="${gameState.currentLocation}"]`);
            const actions = currentLocation.querySelectorAll('.action-icon');
            
            actions.forEach((action, index) => {
                action.style.border = '2px solid #FFD700';
                action.style.animation = 'pulse 1s infinite';
                
                // Ajouter gestionnaire temporaire
                const tempHandler = function() {
                    executeAction(action, tempHandler);
                };
                action.addEventListener('click', tempHandler);
            });

            showGameMessage('Cliquez sur les actions disponibles (surlign√©es)', 'info');
        }

        // Ex√©cuter une action
        function executeAction(actionElement, handler) {
            const title = actionElement.title || actionElement.textContent;
            
            // Retirer le surlignage
            actionElement.style.border = '';
            actionElement.style.animation = '';
            actionElement.removeEventListener('click', handler);
            
            // Ex√©cuter l'action
            if (title.includes('Pouvoir') || actionElement.textContent === 'üí∞') {
                const powerGain = parseInt(title.match(/\d+/)?.[0] || '1');
                gameState.playerPower += powerGain;
                updatePowerDisplay();
                showGameMessage(`+${powerGain} Pouvoir ! Total: ${gameState.playerPower}`, 'success');
            } else if (title.includes('Carte') || actionElement.textContent === 'üÉè') {
                showGameMessage('Action Jouer une Carte ex√©cut√©e', 'success');
            } else if (actionElement.textContent === '‚öîÔ∏è') {
                showGameMessage('Action Attaque ex√©cut√©e', 'success');
            } else if (actionElement.textContent === 'üóëÔ∏è') {
                showGameMessage('Action D√©fausse ex√©cut√©e', 'success');
            } else if (actionElement.textContent === 'üîÆ') {
                showGameMessage('Action Fatalit√© ex√©cut√©e', 'success');
            } else {
                showGameMessage('Action ex√©cut√©e', 'success');
            }

            // D√©cr√©menter les actions restantes
            OFFICIAL_GAME_STATE.actionsRemaining--;
            const countElement = document.getElementById('actionsCount');
            if (countElement) {
                countElement.textContent = OFFICIAL_GAME_STATE.actionsRemaining;
            }

            // V√©rifier si toutes les actions sont termin√©es
            if (OFFICIAL_GAME_STATE.actionsRemaining <= 0) {
                setTimeout(() => {
                    // Fermer la modal actuelle
                    const currentModal = document.querySelector('div[style*="position: fixed"]');
                    if (currentModal) currentModal.remove();
                    
                    // Passer √† la phase de pioche
                    startDrawPhase();
                }, 1000);
            }
        }

        // Phase de pioche
        function startDrawPhase() {
            OFFICIAL_GAME_STATE.phase = 'draw';
            const currentHandSize = document.querySelectorAll('.cards-container .game-card').length;
            const cardsToDraw = Math.max(0, OFFICIAL_GAME_STATE.handLimit - currentHandSize);

            const modal = createGameModal(
                'üÉè Phase Pioche',
                `
                <div style="text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 1rem;">üÉè</div>
                    <h4>Piochez jusqu'√† avoir 4 cartes en main</h4>
                    <p>Cartes en main : ${currentHandSize}</p>
                    <p>Cartes √† piocher : ${cardsToDraw}</p>
                    <div style="margin-top: 1rem;">
                        <button onclick="drawCardsOfficial(${cardsToDraw}); this.closest('div').parentElement.parentElement.parentElement.remove();"
                                style="background: var(--primary-gold); color: var(--primary-dark); border: none; 
                                       padding: 0.8rem 1.5rem; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            Piocher ${cardsToDraw} carte(s)
                        </button>
                    </div>
                </div>
                `
            );
        }

        // Piocher des cartes
        function drawCardsOfficial(count) {
            if (count > 0) {
                showGameMessage(`Vous piochez ${count} carte(s)`, 'info');
                // Simuler la pioche en ajoutant des cartes factices
                for (let i = 0; i < count; i++) {
                    setTimeout(() => {
                        if (typeof drawVillainCard === 'function') {
                            drawVillainCard();
                        }
                    }, i * 200);
                }
            }

            // V√©rifier si d√©fausse n√©cessaire
            setTimeout(() => {
                const finalHandSize = document.querySelectorAll('.cards-container .game-card').length;
                if (finalHandSize > OFFICIAL_GAME_STATE.maxHandSize) {
                    startDiscardPhase(finalHandSize - OFFICIAL_GAME_STATE.maxHandSize);
                } else {
                    endTurnOfficial();
                }
            }, count * 200 + 500);
        }

        // Phase de d√©fausse
        function startDiscardPhase(cardsToDiscard) {
            const modal = createGameModal(
                'üóëÔ∏è Phase D√©fausse',
                `
                <div style="text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 1rem;">üóëÔ∏è</div>
                    <h4>Vous avez plus de 7 cartes en main</h4>
                    <p>Vous devez d√©fausser ${cardsToDiscard} carte(s)</p>
                    <div style="margin-top: 1rem;">
                        <button onclick="this.closest('div').parentElement.parentElement.parentElement.remove(); highlightCardsForDiscard();"
                                style="background: var(--primary-gold); color: var(--primary-dark); border: none; 
                                       padding: 0.8rem 1.5rem; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            Choisir les cartes √† d√©fausser
                        </button>
                    </div>
                </div>
                `
            );
        }

        // Terminer le tour
        function endTurnOfficial() {
            gameState.turnNumber++;
            
            const modal = createGameModal(
                '‚úÖ Fin du Tour',
                `
                <div style="text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 1rem;">‚úÖ</div>
                    <h4>Tour ${gameState.turnNumber - 1} termin√© !</h4>
                    <p>Pr√©paration du tour ${gameState.turnNumber}...</p>
                    <div style="margin-top: 1rem;">
                        <button onclick="this.closest('div').parentElement.parentElement.parentElement.remove(); setTimeout(() => startOfficialTurn(), 1000);"
                                style="background: var(--primary-gold); color: var(--primary-dark); border: none; 
                                       padding: 0.8rem 1.5rem; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            Tour suivant
                        </button>
                    </div>
                </div>
                `
            );

            showGameMessage(`Tour ${gameState.turnNumber - 1} termin√© ! Pr√™t pour le tour ${gameState.turnNumber}`, 'success');
        }

        // Activer le syst√®me au chargement
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                activateOfficialRules();
            }, 2000); // Attendre que tout soit charg√©
        });

        // Am√©liorer la fonction selectLocation existante
        const originalSelectLocation = window.selectLocation;
        window.selectLocation = function(location) {
            if (originalSelectLocation) {
                originalSelectLocation(location);
            }
            
            // Ajouter les animations de lieu
            const locationElement = document.querySelector(`[data-location="${location}"]`);
            if (locationElement && villainBoardAnimations) {
                const currentVillain = gameState.currentPlayer.toLowerCase().replace(' ', '_');
                villainBoardAnimations.highlightCurrentLocation(locationElement, currentVillain);
            }
        };

        // ===== FONCTIONS D'AFFICHAGE =====
        
        function updateDisplay() {
            updateGameInfo();
            updatePlayerHand();
            updateDeckInfo();
            updateLocationDisplay();
        }

        function updateGameInfo() {
            // Mettre √† jour les informations de base
            document.getElementById('current-player').textContent = gameState.currentVillain.name;
            document.getElementById('power-amount').textContent = gameState.power;
            document.getElementById('current-phase').textContent = TURN_PHASES[gameState.phase];
            document.getElementById('actions-remaining').textContent = gameState.actionsRemaining;
        }

        function updatePlayerHand() {
            const handContainer = document.getElementById('hand-container') || createHandContainer();
            handContainer.innerHTML = '';
            
            gameState.hand.forEach(card => {
                const cardElement = createCardElement(card);
                handContainer.appendChild(cardElement);
            });
        }

        function createHandContainer() {
            const container = document.createElement('div');
            container.id = 'hand-container';
            container.className = 'hand-container';
            container.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                display: flex;
                gap: 10px;
                z-index: 1000;
                background: rgba(0,0,0,0.8);
                padding: 15px;
                border-radius: 15px;
                border: 2px solid #DAA520;
                max-width: 90vw;
                overflow-x: auto;
            `;
            document.body.appendChild(container);
            return container;
        }

        function createCardElement(card) {
            const cardDiv = document.createElement('div');
            cardDiv.className = 'card-in-hand';
            cardDiv.innerHTML = `
                <div class="card-name">${card.name}</div>
                <div class="card-cost">${card.cost || 0}üí∞</div>
                <div class="card-effect">${card.effect}</div>
            `;
            cardDiv.style.cssText = `
                min-width: 120px;
                height: 160px;
                background: linear-gradient(135deg, #1a1a2e, #16213e);
                border: 2px solid #DAA520;
                border-radius: 10px;
                padding: 10px;
                cursor: pointer;
                transition: all 0.3s ease;
                color: white;
                font-size: 0.8rem;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
            `;
            
            cardDiv.addEventListener('click', () => playCard(card.id));
            cardDiv.addEventListener('mouseenter', () => {
                cardDiv.style.transform = 'translateY(-10px) scale(1.05)';
                cardDiv.style.borderColor = '#FFA000';
            });
            cardDiv.addEventListener('mouseleave', () => {
                cardDiv.style.transform = 'none';
                cardDiv.style.borderColor = '#DAA520';
            });
            
            return cardDiv;
        }

        function updateDeckInfo() {
            const villain = gameState.currentVillain;
            const deckInfo = document.getElementById('deck-info') || createDeckInfo();
            deckInfo.innerHTML = `
                <div>üÉè Deck M√©chant: ${villain.villainDeck ? villain.villainDeck.length : 0}</div>
                <div>üíÄ Deck Fatalit√©: ${villain.fateDeck ? villain.fateDeck.length : 0}</div>
                <div>üéØ Main: ${gameState.hand.length}/7</div>
            `;
        }

        function createDeckInfo() {
            const info = document.createElement('div');
            info.id = 'deck-info';
            info.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: rgba(0,0,0,0.8);
                color: white;
                padding: 15px;
                border-radius: 10px;
                border: 2px solid #DAA520;
                z-index: 1000;
                font-family: 'Cinzel', serif;
            `;
            document.body.appendChild(info);
            return info;
        }

        function updateLocationDisplay() {
            // Mise √† jour de l'affichage des lieux avec les marqueurs sp√©ciaux
            const locations = document.querySelectorAll('.location-card');
            locations.forEach(locationEl => {
                const locationId = locationEl.dataset.locationId;
                
                // Marqueurs de victoire
                if (gameState.specialMechanics.cursedLocation === locationId) {
                    if (!locationEl.querySelector('.curse-marker')) {
                        const marker = document.createElement('div');
                        marker.className = 'curse-marker';
                        marker.innerHTML = 'üîÆ';
                        locationEl.appendChild(marker);
                    }
                }
                
                // Lieu contr√¥l√© (Jafar)
                if (gameState.specialMechanics.hypnotizedLocation && 
                    gameState.specialMechanics.hypnotizedLocation.locationId === locationId) {
                    locationEl.style.border = '3px solid #9932CC';
                }
            });
        }

        // Initialiser les decks lors de la s√©lection du m√©chant
        function initializeVillainDecks(villainName) {
            const villainCards = VILLAIN_CARDS[villainName];
            if (villainCards) {
                gameState.currentVillain.villainDeck = shuffleDeck([...villainCards.villain]);
                gameState.currentVillain.fateDeck = shuffleDeck([...villainCards.fate]);
                
                // Distribuer la main de d√©part (4 cartes)
                gameState.hand = [];
                for (let i = 0; i < 4; i++) {
                    drawCard('villain');
                }
            }
        }
    </script>
</body>
</html>