<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ° Disney Villainous - Chargement SÃ©quentiel</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/cards.css">
    <link rel="stylesheet" href="css/board.css">
    <link rel="stylesheet" href="css/animations.css">
</head>
<body>
    <!-- Ã‰cran de chargement avec statut -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <h1 class="loading-title">ğŸ° Disney Villainous</h1>
            <div class="loading-spinner"></div>
            <p class="loading-text">PrÃ©paration de votre destinÃ©e malÃ©fique...</p>
            <div id="loading-status" style="margin-top: 20px; font-size: 14px; opacity: 0.8;">
                Initialisation...
            </div>
        </div>
    </div>

    <!-- Menu principal -->
    <div id="main-menu" class="main-menu hidden">
        <div class="menu-background"></div>
        <div class="menu-content">
            <h1 class="game-title">
                <span class="title-disney">Disney</span>
                <span class="title-villainous">Villainous</span>
            </h1>
            <p class="game-subtitle">Incarnez les plus grands mÃ©chants Disney</p>
            
            <div class="menu-buttons">
                <button class="menu-btn primary" onclick="showGameSetup()">
                    ğŸ® Nouvelle Partie
                </button>
                <button class="menu-btn secondary" onclick="showRules()">
                    ğŸ“– RÃ¨gles du Jeu
                </button>
                <button class="menu-btn secondary" onclick="showCredits()">
                    ğŸ† CrÃ©dits
                </button>
            </div>
        </div>
    </div>

    <!-- Configuration de partie (version minimale) -->
    <div id="game-setup" class="game-setup hidden">
        <div class="setup-content">
            <h2>ğŸ­ Configuration de la Partie</h2>
            <p>Interface de configuration en cours de dÃ©veloppement...</p>
            <button onclick="showMainMenu()" class="btn secondary">Retour</button>
        </div>
    </div>

    <!-- Interface de jeu (version minimale) -->
    <div id="game-interface" class="game-interface hidden">
        <div class="game-content">
            <h2>ğŸ® Interface de Jeu</h2>
            <p>Interface de jeu en cours de dÃ©veloppement...</p>
            <button onclick="showMainMenu()" class="btn secondary">Menu Principal</button>
        </div>
    </div>

    <!-- Overlay pour les notifications -->
    <div id="notification-overlay" class="notification-overlay hidden">
        <div class="notification" id="notification">
            <span class="notification-icon">â„¹ï¸</span>
            <span class="notification-text" id="notification-text">Message</span>
        </div>
    </div>

    <script>
        // Fonction de notification immÃ©diate
        function showNotification(message, type = 'info') {
            console.log(`[${type.toUpperCase()}] ${message}`);
            updateLoadingStatus(message);
        }

        function updateLoadingStatus(status) {
            const statusDiv = document.getElementById('loading-status');
            if (statusDiv) {
                statusDiv.textContent = status;
            }
        }

        // Variables globales
        let scriptsLoaded = 0;
        const scripts = [
            { name: 'game-data.js', path: 'js/game-data.js' },
            { name: 'animations-safe.js', path: 'js/animations-safe.js' },
            { name: 'card-manager.js', path: 'js/card-manager.js' },
            { name: 'drag-drop.js', path: 'js/drag-drop.js' },
            { name: 'ui-manager.js', path: 'js/ui-manager.js' },
            { name: 'game-logic.js', path: 'js/game-logic.js' }
        ];

        // Chargement sÃ©quentiel des scripts
        function loadScripts() {
            updateLoadingStatus('Chargement des scripts...');
            loadNextScript(0);
        }

        function loadNextScript(index) {
            if (index >= scripts.length) {
                // Tous les scripts chargÃ©s
                updateLoadingStatus('Scripts chargÃ©s, initialisation...');
                setTimeout(initializeApp, 500);
                return;
            }

            const script = scripts[index];
            updateLoadingStatus(`Chargement ${script.name}...`);

            const scriptElement = document.createElement('script');
            scriptElement.src = script.path;
            
            scriptElement.onload = function() {
                console.log(`âœ… ${script.name} chargÃ©`);
                scriptsLoaded++;
                
                // Test spÃ©cifique pour chaque script
                testScriptLoaded(script.name);
                
                // Charger le script suivant
                setTimeout(() => loadNextScript(index + 1), 100);
            };
            
            scriptElement.onerror = function() {
                console.error(`âŒ Erreur chargement ${script.name}`);
                updateLoadingStatus(`Erreur: ${script.name}`);
                
                // Continuer malgrÃ© l'erreur
                setTimeout(() => loadNextScript(index + 1), 500);
            };
            
            document.head.appendChild(scriptElement);
        }

        function testScriptLoaded(scriptName) {
            switch(scriptName) {
                case 'game-data.js':
                    if (typeof VILLAINS !== 'undefined') {
                        console.log(`âœ… VILLAINS disponible (${Object.keys(VILLAINS).length} mÃ©chants)`);
                    } else {
                        console.warn('âš ï¸ VILLAINS non dÃ©fini');
                    }
                    break;
                    
                case 'animations-safe.js':
                    if (typeof AnimationManager !== 'undefined') {
                        console.log('âœ… AnimationManager disponible');
                        try {
                            window.animationManager = new AnimationManager();
                            console.log('âœ… AnimationManager crÃ©Ã©');
                        } catch (e) {
                            console.warn('âš ï¸ Erreur crÃ©ation AnimationManager:', e.message);
                        }
                    } else {
                        console.warn('âš ï¸ AnimationManager non dÃ©fini');
                    }
                    break;
                    
                case 'card-manager.js':
                    if (typeof CardManager !== 'undefined') {
                        console.log('âœ… CardManager disponible');
                        try {
                            window.cardManager = new CardManager();
                            console.log('âœ… CardManager crÃ©Ã©');
                        } catch (e) {
                            console.warn('âš ï¸ Erreur crÃ©ation CardManager:', e.message);
                        }
                    }
                    break;
                    
                case 'ui-manager.js':
                    if (typeof UIManager !== 'undefined') {
                        console.log('âœ… UIManager disponible');
                        try {
                            window.uiManager = new UIManager();
                            console.log('âœ… UIManager crÃ©Ã©');
                        } catch (e) {
                            console.warn('âš ï¸ Erreur crÃ©ation UIManager:', e.message);
                        }
                    }
                    break;
            }
        }

        function initializeApp() {
            try {
                updateLoadingStatus('Finalisation...');
                
                // Masquer l'Ã©cran de chargement
                setTimeout(() => {
                    const loadingScreen = document.getElementById('loading-screen');
                    const mainMenu = document.getElementById('main-menu');
                    
                    if (loadingScreen) {
                        loadingScreen.style.transition = 'opacity 0.5s ease';
                        loadingScreen.style.opacity = '0';
                        
                        setTimeout(() => {
                            loadingScreen.classList.add('hidden');
                        }, 500);
                    }
                    
                    if (mainMenu) {
                        mainMenu.classList.remove('hidden');
                    }
                    
                    console.log('ğŸ‰ Application initialisÃ©e avec succÃ¨s');
                    
                }, 1000);
                
            } catch (error) {
                console.error('âŒ Erreur initialisation:', error);
                updateLoadingStatus('Erreur d\'initialisation');
            }
        }

        // Fonctions utilitaires
        function showGameSetup() {
            console.log('Configuration du jeu');
            const mainMenu = document.getElementById('main-menu');
            const gameSetup = document.getElementById('game-setup');
            
            if (mainMenu) mainMenu.classList.add('hidden');
            if (gameSetup) gameSetup.classList.remove('hidden');
        }

        function showMainMenu() {
            console.log('Menu principal');
            const screens = ['game-setup', 'game-interface'];
            const mainMenu = document.getElementById('main-menu');
            
            screens.forEach(screenId => {
                const screen = document.getElementById(screenId);
                if (screen) screen.classList.add('hidden');
            });
            
            if (mainMenu) mainMenu.classList.remove('hidden');
        }

        function showRules() {
            showNotification('RÃ¨gles du jeu en dÃ©veloppement...', 'info');
        }

        function showCredits() {
            showNotification('CrÃ©dits en dÃ©veloppement...', 'info');
        }

        // DÃ©marrer le chargement
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸš€ DOM chargÃ©, dÃ©but du chargement des scripts');
            setTimeout(loadScripts, 500);
        });

        // Gestion des erreurs
        window.addEventListener('error', (e) => {
            console.error('âŒ Erreur globale:', e.message);
            updateLoadingStatus(`Erreur: ${e.message}`);
        });
    </script>
</body>
</html>